"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{3712:function(e,t,r){let i,n,s,o,a,l;r.r(t),r.d(t,{default:function(){return nb}});var d,c,h,u,p,f=r(8256),m=r(6663),g=r(1366),v=r(4143),y=r(375),_=r(8378),b=r(3148),w=r(266);class ${constructor(){this._emitter=new $.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){class t{constructor(e=null){this._target=e,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear(),this._listenersMap=null}emit(e,t){let r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;let i=this._target||this;return[...r].forEach(e=>{e.call(i,t)}),r.length>0}on(e,t){if(Array.isArray(e)){let r=e.map(e=>this.on(e,t));return(0,b.AL)(r)}if(e.includes(","))throw TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);let i=this._listenersMap.get(e)||[];return i.push(t),this._listenersMap.set(e,i),{remove:()=>{let r=this._listenersMap&&this._listenersMap.get(e)||[],i=r.indexOf(t);i>=0&&r.splice(i,1)}}}once(e,t){let r=this.on(e,e=>{r.remove(),t.call(null,e)});return r}hasEventListener(e){let t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}e.EventEmitter=t,e.EventedMixin=e=>(0,m._)([(0,w.j)("esri.core.Evented")],class extends e{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}});let r=class extends _.Z{constructor(){super(...arguments),this._emitter=new $.EventEmitter(this)}destroy(){this._emitter.clear()}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};r=(0,m._)([(0,w.j)("esri.core.Evented")],r),e.EventedAccessor=r}($||($={}));let I=$;var S=r(9546),k=r(186),A=r(6745),x=r(4353),U=r(1681),D=r(8280);function T(e,t,r={}){return L(e,t,r,C)}function L(e,t,r={},i){let n=null,s=r.once?(e,r)=>{i(e)&&((0,U.hw)(n),t(e,r))}:(e,r)=>{i(e)&&t(e,r)};if(n=(0,D.aQ)(e,s,r.sync,r.equals),r.initial){let o=e();s(o,o)}return n}function C(e){return!0}function R(e){return!!e}r(3235);let O={initial:!0};var N=r(3466),E=r(1977);r(1453),r(5418);var P=r(3802),B=r(1130),j=r(5709);let F=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale;function M(){return F??globalThis.navigator?.language??"en"}function q(){return void 0===n&&(n=M()),n}let V=[],z=[];function H(e){return z.push(e),{remove(){V.splice(z.indexOf(e),1)}}}globalThis.addEventListener?.("languagechange",function(){let e=i??M();n!==e&&(n=e,[...z].forEach(t=>{t.call(null,e)}),[...V].forEach(t=>{t.call(null,e)}))});let W={year:"numeric",month:"numeric",day:"numeric"},G={year:"numeric",month:"long",day:"numeric"},Z={year:"numeric",month:"short",day:"numeric"},J={year:"numeric",month:"long",weekday:"long",day:"numeric"},Y={hour:"numeric",minute:"numeric"},X={...Y,second:"numeric"},K={"short-date":W,"short-date-short-time":{...W,...Y},"short-date-short-time-24":{...W,...Y,hour12:!1},"short-date-long-time":{...W,...X},"short-date-long-time-24":{...W,...X,hour12:!1},"short-date-le":W,"short-date-le-short-time":{...W,...Y},"short-date-le-short-time-24":{...W,...Y,hour12:!1},"short-date-le-long-time":{...W,...X},"short-date-le-long-time-24":{...W,...X,hour12:!1},"long-month-day-year":G,"long-month-day-year-short-time":{...G,...Y},"long-month-day-year-short-time-24":{...G,...Y,hour12:!1},"long-month-day-year-long-time":{...G,...X},"long-month-day-year-long-time-24":{...G,...X,hour12:!1},"day-short-month-year":Z,"day-short-month-year-short-time":{...Z,...Y},"day-short-month-year-short-time-24":{...Z,...Y,hour12:!1},"day-short-month-year-long-time":{...Z,...X},"day-short-month-year-long-time-24":{...Z,...X,hour12:!1},"long-date":J,"long-date-short-time":{...J,...Y},"long-date-short-time-24":{...J,...Y,hour12:!1},"long-date-long-time":{...J,...X},"long-date-long-time-24":{...J,...X,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Y,"long-time":X},Q=(0,j.w)()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),ee=(Q.apiValues,Q.toJSON.bind(Q),Q.fromJSON.bind(Q),{ar:"ar-u-nu-latn-ca-gregory"}),et=new WeakMap,er=K["short-date-short-time"];function ei(e,t){return(function(e){let t=e||er,r=et.get(t);if(!r){let i=q(),n=ee[q()]||i;r=new Intl.DateTimeFormat(n,t),et.set(t,r)}return r})(t).format(e)}H(()=>{et=new WeakMap,er=K["short-date-short-time"]});let en={ar:"ar-u-nu-latn"},es=new WeakMap,eo={};function ea(e,t){return -0===e&&(e=0),(function(e){let t=e||eo;if(!es.has(t)){let r=q(),i=en[q()]||r;es.set(t,new Intl.NumberFormat(i,e))}return(0,U.j0)(es.get(t))})(t).format(e)}H(()=>{es=new WeakMap,eo={}});let el=P.Z.getLogger("esri.intl.substitute");function ed(e){switch(typeof e){case"string":return e;case"number":return ea(e);case"boolean":return""+e;default:return e instanceof Date?ei(e):""}}let ec=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,eh={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0},eu=[],ep=new Map;async function ef(e){let t=q();ep.has(e)||ep.set(e,em(e,t));let r=ep.get(e);return r&&await ev.add(r),r}async function em(e,t){let r=[];for(let i of eu)if(eg(i.pattern,e))try{return await i.fetchMessageBundle(e,t)}catch(n){r.push(n)}if(r.length)throw new y.Z("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:r});throw new y.Z("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function eg(e,t){return"string"==typeof e?t.startsWith(e):e.test(t)}H(()=>{ep.clear()});let ev=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=(0,x.dD)())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function ey(e,t,r,i){let n;let s=t.exec(r);if(!s)throw new y.Z("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${t}"`);let o=s[1]?`${s[1]}/`:"",a=s[2],l=function(e){if(!ec.test(e))return null;let t=ec.exec(e);if(null===t)return null;let[,r,i]=t,n=r+(i?"-"+i.toUpperCase():"");return eh[n]?n:eh[r]?r:null}(i),d=`${o}${a}.json`,c=l?`${o}${a}_${l}.json`:d;try{n=await e_(e(c))}catch(u){if(c===d)throw new y.Z("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:u});try{n=await e_(e(d))}catch(h){throw new y.Z("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:h})}}return n}async function e_(e){if((0,U.pC)(eb.fetchBundleAsset))return eb.fetchBundleAsset(e);let t=await (0,v.default)(e,{responseType:"text"});return JSON.parse(t.data)}let eb={},ew=P.Z.getLogger("esri.assets");function e$(e){if(!g.Z.assetsPath)throw ew.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new y.Z("assets:path-not-set","config.assetsPath is not set");return(0,N.v_)(g.Z.assetsPath,e)}d=new class{constructor({base:e="",pattern:t,location:r=new URL(window.location.href)}){let i;i="string"==typeof r?e=>new URL(e,new URL(r,window.location.href)).href:r instanceof URL?e=>new URL(e,r).href:r,this.pattern="string"==typeof t?RegExp(`^${t}`):t,this.getAssetUrl=i,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,t){return ey(this.getAssetUrl,this.matcher,e,t)}}({pattern:"esri/",location:e$}),eu.includes(d)||(function(e){for(let t of ep.keys())eg(e.pattern,t)&&ep.delete(t)}(d),eu.unshift(d)),(()=>{if("function"==typeof Element.prototype.closest)return(e,t)=>e.closest(t);let e=Element.prototype.matches||Element.prototype.msMatchesSelector;return(t,r)=>{let i=t;do{if(e.call(i,r))return i;i=i.parentElement}while(null!==i&&1===i.nodeType);return null}})();var eI=r(9236);r(9994),(c=u||(u={}))[c.PENDING=0]="PENDING",c[c.RESOLVED=1]="RESOLVED",c[c.REJECTED=2]="REJECTED";class eS{constructor(e){this.instance=e,this._resolver=(0,x.dD)(),this._status=u.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=u.RESOLVED,this._cleanUp()},()=>{this._status=u.REJECTED,this._cleanUp()})}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===u.RESOLVED}isRejected(){return this._status===u.REJECTED}isFulfilled(){return this._status!==u.PENDING}abort(){this._resolver.reject((0,x.zE)())}when(e,t){return this._resolver.promise.then(e,t)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;let e=(0,x.dD)(),t=[...this._resolvingPromises,(0,U.j0)(e.promise)],r=this._allPromise=Promise.all(t);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve(this.instance)},e=>{this.isFulfilled()||this._allPromise!==r||(0,x.D_)(e)||this._resolver.reject(e)}),e.resolve()}}let ek=e=>(0,m._)([(0,w.j)("esri.core.Promise")],class extends e{constructor(...e){super(...e),this._promiseProps=new eS(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(e,t){return new Promise((e,t)=>{this._promiseProps.when(e,t)}).then(e,t)}catch(e){return this.when(null,e)}addResolvingPromise(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)}}),eA=class extends ek(_.Z){};eA=(0,m._)([(0,w.j)("esri.core.Promise")],eA);let ex="randomUUID"in crypto;var eU=r(2003),eD=r(5860),eT=r(4163),eL=function(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},eC={exports:{}},eR={},eO={exports:{}},eN={};function eE(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}var eP=/javascript\s*\:/img;eN.whiteList=eE(),eN.getDefaultWhiteList=eE,eN.onAttr=function(e,t,r){},eN.onIgnoreAttr=function(e,t,r){},eN.safeAttrValue=function(e,t){return eP.test(t)?"":t};var eB={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1},forEach:function(e,t,r){var i,n;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,n=e.length;i<n;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},ej=function(e,t){";"!==(e=eB.trimRight(e))[e.length-1]&&(e+=";");var r=e.length,i=!1,n=0,s=0,o="";function a(){if(!i){var r=eB.trim(e.slice(n,s)),a=r.indexOf(":");if(-1!==a){var l=eB.trim(r.slice(0,a)),d=eB.trim(r.slice(a+1));if(l){var c=t(n,o.length,l,d,r);c&&(o+=c+"; ")}}}n=s+1}for(;s<r;s++){var l=e[s];if("/"===l&&"*"===e[s+1]){var d=e.indexOf("*/",s+2);if(-1===d)break;n=(s=d+1)+1,i=!1}else"("===l?i=!0:")"===l?i=!1:";"===l?i||a():"\n"===l&&a()}return eB.trim(o)};function eF(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).whiteList=e.whiteList||eN.whiteList,e.onAttr=e.onAttr||eN.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||eN.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||eN.safeAttrValue,this.options=e}eF.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,i=t.onAttr,n=t.onIgnoreAttr,s=t.safeAttrValue;return ej(e,function(e,t,o,a,l){var d=r[o],c=!1;if(!0===d?c=d:"function"==typeof d?c=d(a):d instanceof RegExp&&(c=d.test(a)),!0!==c&&(c=!1),a=s(o,a)){var h={position:t,sourcePosition:e,source:l,isWhite:c};if(c){var u=i(o,a,h);return null==u?o+":"+a:u}var u=n(o,a,h);if(null!=u)return u}})},function(e,t){for(var r in(t=e.exports=function(e,t){return new eF(t).process(e)}).FilterCSS=eF,eN)t[r]=eN[r]}(eO,eO.exports);var eM={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1},forEach:function(e,t,r){var i,n;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,n=e.length;i<n;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}},eq=eO.exports.FilterCSS,eV=eO.exports.getDefaultWhiteList;function ez(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var eH=new eq;function eW(e){return e.replace(eG,"&lt;").replace(eZ,"&gt;")}var eG=/</g,eZ=/>/g,eJ=/"/g,eY=/&quot;/g,eX=/&#([a-zA-Z0-9]*);?/gim,eK=/&colon;?/gim,eQ=/&newline;?/gim,e0=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,e1=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,e2=/u\s*r\s*l\s*\(.*/gi;function e4(e){return e.replace(eJ,"&quot;")}function e3(e){return e.replace(eY,'"')}function e6(e){return e.replace(eX,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function e8(e){return e.replace(eK,":").replace(eQ," ")}function e9(e){for(var t="",r=0,i=e.length;r<i;r++)t+=32>e.charCodeAt(r)?" ":e.charAt(r);return eM.trim(t)}function e7(e){return e=e9(e=e8(e=e6(e=e3(e))))}function e5(e){return e=eW(e=e4(e))}eR.whiteList=ez(),eR.getDefaultWhiteList=ez,eR.onTag=function(e,t,r){},eR.onIgnoreTag=function(e,t,r){},eR.onTagAttr=function(e,t,r){},eR.onIgnoreTagAttr=function(e,t,r){},eR.safeAttrValue=function(e,t,r,i){if(r=e7(r),"href"===t||"src"===t){if("#"===(r=eM.trim(r)))return"#";if(!("http://"===r.substr(0,7)||"https://"===r.substr(0,8)||"mailto:"===r.substr(0,7)||"tel:"===r.substr(0,4)||"data:image/"===r.substr(0,11)||"ftp://"===r.substr(0,6)||"./"===r.substr(0,2)||"../"===r.substr(0,3)||"#"===r[0]||"/"===r[0]))return""}else if("background"===t){if(e0.lastIndex=0,e0.test(r))return""}else if("style"===t){if(e1.lastIndex=0,e1.test(r)||(e2.lastIndex=0,e2.test(r)&&(e0.lastIndex=0,e0.test(r))))return"";!1!==i&&(r=(i=i||eH).process(r))}return r=e5(r)},eR.escapeHtml=eW,eR.escapeQuote=e4,eR.unescapeQuote=e3,eR.escapeHtmlEntities=e6,eR.escapeDangerHtml5Entities=e8,eR.clearNonPrintableCharacter=e9,eR.friendlyAttrValue=e7,eR.escapeAttrValue=e5,eR.onIgnoreTagStripAll=function(){return""},eR.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var r=!Array.isArray(e),i=[],n=!1;return{onIgnoreTag:function(s,o,a){if(r?0:-1===eM.indexOf(e,s))return t(s,o,a);if(!a.isClosing)return n||(n=a.position),"[removed]";var l="[/removed]",d=a.position+l.length;return i.push([!1!==n?n:a.position,d]),n=!1,l},remove:function(e){var t="",r=0;return eM.forEach(i,function(i){t+=e.slice(r,i[0]),r=i[1]}),t+=e.slice(r)}}},eR.stripCommentTag=function(e){for(var t="",r=0;r<e.length;){var i=e.indexOf("<!--",r);if(-1===i){t+=e.slice(r);break}t+=e.slice(r,i);var n=e.indexOf("-->",i);if(-1===n)break;r=n+3}return t},eR.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||10===t||13===t)})).join("")},eR.cssFilter=eH,eR.getDefaultCSSWhiteList=eV;var te={},tt=/[^a-zA-Z0-9\\_:.-]/gim;function tr(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?e.substr(1,e.length-2):e}te.parseTag=function(e,t,r){var i="",n=0,s=!1,o=!1,a=0,l=e.length,d="",c="";e:for(a=0;a<l;a++){var h=e.charAt(a);if(!1===s){if("<"===h){s=a;continue}}else if(!1===o){if("<"===h){i+=r(e.slice(n,a)),s=a,n=a;continue}if(">"===h){i+=r(e.slice(n,s)),d=function(e){var t,r=eM.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=eM.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(c=e.slice(s,a+1)),i+=t(s,i.length,d,c,"</"===c.slice(0,2)),n=a+1,s=!1;continue}if('"'===h||"'"===h)for(var u=1,p=e.charAt(a-u);""===p.trim()||"="===p;){if("="===p){o=h;continue e}p=e.charAt(a-++u)}}else if(h===o){o=!1;continue}}return n<e.length&&(i+=r(e.substr(n))),i},te.parseAttr=function(e,t){var r=0,i=0,n=[],s=!1,o=e.length;function a(e,r){if(!((e=(e=eM.trim(e)).replace(tt,"").toLowerCase()).length<1)){var i=t(e,r||"");i&&n.push(i)}}for(var l=0;l<o;l++){var d,c=e.charAt(l);if(!1===s&&"="===c){s=e.slice(r,l),r=l+1,i='"'===e.charAt(r)||"'"===e.charAt(r)?r:function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r){if("'"===r||'"'===r)return t;return -1}}}(e,l+1);continue}if(!1!==s&&l===i){if(-1===(d=e.indexOf(c,l+1)))break;a(s,eM.trim(e.slice(i+1,d))),s=!1,r=(l=d)+1;continue}if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===s){if(-1===(d=function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r){if("="===r)return t;return -1}}}(e,l))){a(eM.trim(e.slice(r,l))),s=!1,r=l+1;continue}l=d-1;continue}if(-1!==(d=function(e,t){for(;t>0;t--){var r=e[t];if(" "!==r){if("="===r)return t;return -1}}}(e,l-1)))continue;a(s,tr(eM.trim(e.slice(r,l)))),s=!1,r=l+1;continue}}return r<e.length&&(!1===s?a(e.slice(r)):a(s,tr(eM.trim(e.slice(r))))),eM.trim(n.join(" "))};var ti=eO.exports.FilterCSS,tn=te.parseTag,ts=te.parseAttr;function to(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=eR.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=function(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map(function(e){return e.toLowerCase()}):t[r.toLowerCase()]=e[r];return t}(e.whiteList||e.allowList):e.whiteList=eR.whiteList,e.onTag=e.onTag||eR.onTag,e.onTagAttr=e.onTagAttr||eR.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||eR.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||eR.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||eR.safeAttrValue,e.escapeHtml=e.escapeHtml||eR.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new ti(e.css))}to.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,i=t.onTag,n=t.onIgnoreTag,s=t.onTagAttr,o=t.onIgnoreTagAttr,a=t.safeAttrValue,l=t.escapeHtml,d=this.cssFilter;t.stripBlankChar&&(e=eR.stripBlankChar(e)),t.allowCommentTag||(e=eR.stripCommentTag(e));var c=!1;t.stripIgnoreTagBody&&(n=(c=eR.StripTagBody(t.stripIgnoreTagBody,n)).onIgnoreTag);var h=tn(e,function(e,t,c,h,u){var p={sourcePosition:e,position:t,isClosing:u,isWhite:Object.prototype.hasOwnProperty.call(r,c)},f=i(c,h,p);if(null!=f)return f;if(p.isWhite){if(p.isClosing)return"</"+c+">";var m=function(e){var t=eM.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=eM.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=eM.trim(e.slice(0,-1))),{html:e,closing:r}}(h),g=r[c],v=ts(m.html,function(e,t){var r=-1!==eM.indexOf(g,e),i=s(c,e,t,r);return null!=i?i:r?(t=a(c,e,t,d))?e+'="'+t+'"':e:null!=(i=o(c,e,t,r))?i:void 0});return h="<"+c,v&&(h+=" "+v),m.closing&&(h+=" /"),h+=">"}return null!=(f=n(c,h,p))?f:l(h)},l);return c&&(h=c.remove(h)),h},function(e,t){function r(e,t){return new to(t).process(e)}(t=e.exports=r).filterXSS=r,t.FilterXSS=to,function(){for(var e in eR)t[e]=eR[e];for(var r in te)t[r]=te[r]}(),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)}(eC,eC.exports);var ta=function(){function e(e,t){var r,i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(e,t,r,n){return"a"===e&&"href"===t||("img"===e||"source"===e)&&"src"===t?i.sanitizeUrl(r):eC.exports.safeAttrValue(e,t,r,n)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"},e&&!t?r=e:e&&t?(r=Object.create(this.arcgisFilterOptions),Object.keys(e).forEach(function(t){"whiteList"===t?r.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]):r[t]=e[t]})):(r=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=r,this._xssFilter=new eC.exports.FilterXSS(r)}return e.prototype.sanitize=function(e,t){switch(void 0===t&&(t={}),typeof e){case"number":if(isNaN(e)||!isFinite(e))return null;return e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,t);default:if(t.allowUndefined&&void 0===e)return;return null}},e.prototype.sanitizeUrl=function(e,t){var r=(null!=t?t:{}).isProtocolRequired,i=this._trim(e.substring(0,e.indexOf(":"))),n=/^#/.test(e),s=i&&this.allowedProtocols.indexOf(i.toLowerCase())>-1;return"/"===e||n||s?eC.exports.escapeAttrValue(e):i||void 0===r||r?"":eC.exports.escapeAttrValue("https://".concat(e))},e.prototype.sanitizeHTMLAttribute=function(e,t,r,i){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(e,t,r,i):eC.exports.safeAttrValue(e,t,r,i)},e.prototype.validate=function(e,t){void 0===t&&(t={});var r=this.sanitize(e,t);return{isValid:e===r,sanitized:r}},e.prototype.encodeHTML=function(e){var t=this;return String(e).replace(/[&<>"'\/]/g,function(e){return t._entityMap[e]})},e.prototype.encodeAttrValue=function(e){var t=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,i){return t.test(r)?r:"&#x".concat(Number(e.charCodeAt(i)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(r){Array.isArray(e[r])&&Array.isArray(t[r])?t[r]=t[r].concat(e[r]):t[r]=e[r]})}),t},e.prototype._iterateOverObject=function(e,t){var r=this;void 0===t&&(t={});try{var i=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(e,n){var s=r.validate(n,t);return s.isValid?e.concat([n]):(i=!0,e.concat([s.sanitized]))},[]);else if(eL(e))n=Object.keys(e).reduce(function(n,s){var o=e[s],a=r.validate(o,t);return a.isValid?n[s]=o:(i=!0,n[s]=a.sanitized),n},{});else{if(t.allowUndefined&&void 0===e)return;return null}if(i)return n;return e}catch(s){return null}},e.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},e}(),tl=r(904);let td=new Map;function tc(e){td.delete(e)}let th=P.Z.getLogger("esri.widgets.support.widgetUtils");function tu(e){let t=tl.Z.acquire();for(let r=0;r<arguments.length;r++){let i=arguments[r],n=typeof i;if("string"===n)t.push(i);else if(Array.isArray(i))t.push.apply(t,i);else if("object"===n)for(let s in i)i[s]&&t.push(s)}let o=t.join(" ");return tl.Z.release(t),o}function tp(e){this[e.getAttribute("data-node-ref")]=e}(()=>{let e=new Map,t=new ResizeObserver(t=>{for(let r of(td.clear(),t))e.get(r.target)?.(r)});return(r,i,n)=>(e.has(r)&&th.error("Already observing element",r),e.set(r,i),t.observe(r,n),(0,b.kB)(()=>{t.unobserve(r),e.delete(r)}))})();let tf=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce((e,t)=>(e[t]=[],e),{}),tm=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],tg=new ta({whiteList:tf,onTagAttr(e,t,r){let i=`${t}="${r}"`;if(tm.includes(t))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),tv="http://www.w3.org/",ty=`${tv}2000/svg`,t_=`${tv}1999/xlink`,tb,tw=[],t$=(e,t)=>{let r={};return Object.keys(e).forEach(t=>{r[t]=e[t]}),t&&Object.keys(t).forEach(e=>{r[e]=t[e]}),r},tI=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),tS=e=>{if("string"!=typeof e)throw Error("Style values must be strings")},tk=(e,t,r)=>{if(""!==t.vnodeSelector){for(let i=r;i<e.length;i++)if(tI(e[i],t))return i}return -1},tA=(e,t,r,i)=>{let n=e[t];if(""===n.vnodeSelector)return;let s=n.properties;if(!(s?void 0===s.key?s.bind:s.key:void 0)){for(let o=0;o<e.length;o++)if(o!==t&&tI(e[o],n))throw Error(`${r.vnodeSelector} had a ${n.vnodeSelector} child ${"added"===i?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},tx=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},tU=[],tD=!1,tT=e=>{(e.children||[]).forEach(tT),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},tL=()=>{tD=!1,tU.forEach(tT),tU.length=0},tC=e=>{tU.push(e),tD||(tD=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(tL,{timeout:16}):setTimeout(tL,16))},tR=e=>{let t=e.domNode;if(e.properties){let r=e.properties.exitAnimation;if(r){t.style.pointerEvents="none";let i=()=>{t.parentNode&&(t.parentNode.removeChild(t),tC(e))};return void r(t,i,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),tC(e))},tO=(e,t,r)=>{if(!t)return;let i=r.eventHandlerInterceptor,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){let a=n[o],l=t[a];if("className"===a)throw Error('Property "className" is not supported, use "class".');if("class"===a)tB(e,l,!0);else if("classes"===a){let d=Object.keys(l),c=d.length;for(let h=0;h<c;h++){let u=d[h];l[u]&&e.classList.add(u)}}else if("styles"===a){let p=Object.keys(l),f=p.length;for(let m=0;m<f;m++){let g=p[m],v=l[g];v&&(tS(v),r.styleApplyer(e,g,v))}}else if("key"!==a&&null!=l){let y=typeof l;"function"===y?(0===a.lastIndexOf("on",0)&&(i&&(l=i(a,l,e,t)),"oninput"===a&&function(){let e=l;l=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[a]=l):r.namespace===ty?"href"===a?e.setAttributeNS(t_,a,l):e.setAttribute(a,l):"string"===y&&"value"!==a?"innerHTML"===a?e[a]=tg.sanitize(l):e.setAttribute(a,l):e[a]=l}}},tN=(e,t,r)=>{if(t)for(let i of t)tP(i,e,void 0,r)},tE=(e,t,r)=>{tN(e,t.children,r),t.text&&(e.textContent=t.text),tO(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},tP=(e,t,r,i)=>{let n,s=0,o=e.vnodeSelector,a=t.ownerDocument;if(""===o)n=e.domNode=a.createTextNode(e.text),void 0!==r?t.insertBefore(n,r):t.appendChild(n);else{for(let l=0;l<=o.length;++l){let d=o.charAt(l);if(l===o.length||"."===d||"#"===d){let c=o.charAt(s-1),h=o.slice(s,l);"."===c?n.classList.add(h):"#"===c?n.id=h:("svg"===h&&(i=t$(i,{namespace:ty})),void 0!==i.namespace?n=e.domNode=a.createElementNS(i.namespace,h):(n=e.domNode=e.domNode||a.createElement(h),"input"===h&&e.properties&&void 0!==e.properties.type&&n.setAttribute("type",e.properties.type)),void 0!==r?t.insertBefore(n,r):n.parentNode!==t&&t.appendChild(n)),s=l+1}}tE(n,e,i)}},tB=(e,t,r)=>{t&&t.split(" ").forEach(t=>{t&&e.classList.toggle(t,r)})},tj=(e,t,r,i)=>{if(!r)return;let n=!1,s=Object.keys(r),o=s.length;for(let a=0;a<o;a++){let l=s[a],d=r[l],c=t[l];if("class"===l)c!==d&&(tB(e,c,!1),tB(e,d,!0));else if("classes"===l){let h=e.classList,u=Object.keys(d),p=u.length;for(let f=0;f<p;f++){let m=u[f],g=!!d[m];!!c[m]!==g&&(n=!0,g?h.add(m):h.remove(m))}}else if("styles"===l){let v=Object.keys(d),y=v.length;for(let _=0;_<y;_++){let b=v[_],w=d[b];w!==c[b]&&(n=!0,w?(tS(w),i.styleApplyer(e,b,w)):i.styleApplyer(e,b,""))}}else if(d||"string"!=typeof c||(d=""),"value"===l){let $=e[l];$!==d&&(e["oninput-value"]?$===e["oninput-value"]:d!==c)&&(e[l]=d,e["oninput-value"]=void 0),d!==c&&(n=!0)}else if(d!==c){let I=typeof d;"function"===I&&i.eventHandlerInterceptor||(i.namespace===ty?"href"===l?e.setAttributeNS(t_,l,d):e.setAttribute(l,d):"string"===I?"innerHTML"===l?e[l]=tg.sanitize(d):"role"===l&&""===d?e.removeAttribute(l):e.setAttribute(l,d):e[l]!==d&&(e[l]=d),n=!0)}}return n},tF=(e,t,r,i,n)=>{if(r===i)return!1;i=i||tw;let s,o=(r=r||tw).length,a=i.length,l=0,d=0,c=!1;for(;d<a;){let h=l<o?r[l]:void 0,u=i[d];if(void 0!==h&&tI(h,u))c=tb(h,u,n)||c,l++;else{let p=tk(r,u,l+1);if(p>=0){for(s=l;s<p;s++)tR(r[s]),tA(r,s,e,"removed");c=tb(r[p],u,n)||c,l=p+1}else tP(u,t,l<o?r[l].domNode:void 0,n),tx(u),tA(i,d,e,"added")}d++}if(o>l)for(s=l;s<o;s++)tR(r[s]),tA(r,s,e,"removed");return c};tb=(e,t,r)=>{let i=e.domNode,n=!1;if(e===t)return!1;let s=!1;if(""===t.vnodeSelector){if(t.text!==e.text){let o=i.ownerDocument.createTextNode(t.text);return i.parentNode.replaceChild(o,i),t.domNode=o,n=!0}t.domNode=i}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(r=t$(r,{namespace:ty})),e.text!==t.text&&(s=!0,void 0===t.text?i.removeChild(i.firstChild):i.textContent=t.text),t.domNode=i,s=tF(t,i,e.children,t.children,r)||s,s=tj(i,e.properties,t.properties,r)||s,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[i,r,t.vnodeSelector,t.properties,t.children]);return s&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(i,t.properties,e.properties),n};let tM=(e,t)=>({getLastRender:()=>e,update(r){if(e.vnodeSelector!==r.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=e;e=r,tb(i,r,t)},domNode:e.domNode}),tq={namespace:void 0,performanceLogger(){},eventHandlerInterceptor:void 0,styleApplyer(e,t,r){"-"===t.charAt(0)?e.style.setProperty(t,r):e.style[t]=r}},tV=e=>t$(tq,e),tz={create:(e,t)=>(t=tV(t),tP(e,document.createElement("div"),void 0,t),tM(e,t)),append:(e,t,r)=>(tP(t,e,void 0,r=tV(r)),tM(t,r)),insertBefore:(e,t,r)=>(r=tV(r),tP(t,e.parentNode,e,r),tM(t,r)),merge:(e,t,r)=>(r=tV(r),t.domNode=e,tE(e,t,r),tM(t,r)),replace:(e,t,r)=>(r=tV(r),tP(t,e.parentNode,e,r),e.parentNode.removeChild(e),tM(t,r))};Array.prototype.find||((e,t)=>e.filter(t)[0]);let tH={handleInterceptedEvent:(e,t,r,i)=>(e.scheduleRender(),t.properties[`on${i.type}`].apply(t.properties.bind||r,[i]))},tW={namespace:void 0,performanceLogger(){},eventHandlerInterceptor:void 0,styleApplyer(e,t,r){e.style[t]=r}},tG=e=>({...tW,...e}),tZ=(e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r},tJ=(e,t)=>e.find(t),tY=(e,t,r=!1)=>{let i=e;return t.forEach((e,n)=>{let s=i?.children?tJ(i.children,t=>t.domNode===e):void 0;r&&!s&&n!==t.length-1||(i=s)}),i},tX={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0},tK=0,tQ=!1,t0=!1,t1=!1,t2=!1,t4=0;tX.isDev,tX.isTesting;let t3=e=>ie.$resourcesUrl$=e,t6=(e,t="")=>{if(!BUILD.profile||!performance.mark)return()=>{};{let r=`st:${e}:${t}:${tK++}`;return performance.mark(r),()=>performance.measure(`[Stencil] ${e}() <${t}>`,r)}},t8="sty-id",t9="c-id",t7="http://www.w3.org/1999/xlink",t5={},re=e=>null!=e,rt=e=>"object"==(e=typeof e)||"function"===e,rr=(e,t,...r)=>{let i=null,n=null,s=null,o=!1,a=!1,l=[],d=t=>{for(let r=0;r<t.length;r++)Array.isArray(i=t[r])?d(i):null!=i&&"boolean"!=typeof i&&((o="function"!=typeof e&&!rt(i))?i=String(i):tX.isDev&&"function"!=typeof e&&void 0===i.$flags$&&r6(`vNode passed as children has unexpected type.
Make sure it's using the correct h() function.
Empty objects can also be the cause, look for JSX comments that became objects.`),o&&a?l[l.length-1].$text$+=i:l.push(o?ri(null,i):i),a=o)};if(d(r),t&&(tX.isDev&&"input"===e&&rd(t),tX.vdomKey&&t.key&&(n=t.key),tX.slotRelocation&&t.name&&(s=t.name),tX.vdomClass)){let c=t.className||t.class;c&&(t.class="object"!=typeof c?c:Object.keys(c).filter(e=>c[e]).join(" "))}if(tX.isDev&&l.some(rs)&&r6(`The <Host> must be the single root component. Make sure:
- You are NOT using hostData() and <Host> in the same component.
- <Host> is used once, and it's the single root component of the render() function.`),tX.vdomFunctional&&"function"==typeof e)return e(null===t?{}:t,l,ro);let h=ri(e,null);return h.$attrs$=t,l.length>0&&(h.$children$=l),tX.vdomKey&&(h.$key$=n),tX.slotRelocation&&(h.$name$=s),h},ri=(e,t)=>{let r={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return tX.vdomAttribute&&(r.$attrs$=null),tX.vdomKey&&(r.$key$=null),tX.slotRelocation&&(r.$name$=null),r},rn={},rs=e=>e&&e.$tag$===rn,ro={forEach:(e,t)=>e.map(ra).forEach(t),map:(e,t)=>e.map(ra).map(t).map(rl)},ra=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),rl=e=>{if("function"==typeof e.vtag){let t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),rr(e.vtag,t,...e.vchildren||[])}let r=ri(e.vtag,e.vtext);return r.$attrs$=e.vattrs,r.$children$=e.vchildren,r.$key$=e.vkey,r.$name$=e.vname,r},rd=e=>{let t=Object.keys(e),r=t.indexOf("value");if(-1===r)return;let i=t.indexOf("type"),n=t.indexOf("min"),s=t.indexOf("max"),o=t.indexOf("step");(r<i||r<n||r<s||r<o)&&r8('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},rc=(e,t,r,i,n,s,o)=>{let a,l,d,c;if(1===s.nodeType){for((a=s.getAttribute(t9))&&((l=a.split("."))[0]===o||"0"===l[0])&&(d={$flags$:0,$hostId$:l[0],$nodeId$:l[1],$depth$:l[2],$index$:l[3],$tag$:s.tagName.toLowerCase(),$elm$:s,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},t.push(d),s.removeAttribute(t9),e.$children$||(e.$children$=[]),e.$children$[d.$index$]=d,e=d,i&&"0"===d.$depth$&&(i[d.$index$]=d.$elm$)),c=s.childNodes.length-1;c>=0;c--)rc(e,t,r,i,n,s.childNodes[c],o);if(s.shadowRoot)for(c=s.shadowRoot.childNodes.length-1;c>=0;c--)rc(e,t,r,i,n,s.shadowRoot.childNodes[c],o)}else if(8===s.nodeType)((l=s.nodeValue.split("."))[1]===o||"0"===l[1])&&(a=l[0],d={$flags$:0,$hostId$:l[1],$nodeId$:l[2],$depth$:l[3],$index$:l[4],$elm$:s,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===a?(d.$elm$=s.nextSibling,d.$elm$&&3===d.$elm$.nodeType&&(d.$text$=d.$elm$.textContent,t.push(d),s.remove(),e.$children$||(e.$children$=[]),e.$children$[d.$index$]=d,i&&"0"===d.$depth$&&(i[d.$index$]=d.$elm$))):d.$hostId$===o&&("s"===a?(d.$tag$="slot",l[5]?s["s-sn"]=d.$name$=l[5]:s["s-sn"]="",s["s-sr"]=!0,BUILD.shadowDom&&i&&(d.$elm$=r5.createElement(d.$tag$),d.$name$&&d.$elm$.setAttribute("name",d.$name$),s.parentNode.insertBefore(d.$elm$,s),s.remove(),"0"===d.$depth$&&(i[d.$index$]=d.$elm$)),r.push(d),e.$children$||(e.$children$=[]),e.$children$[d.$index$]=d):"r"===a&&(BUILD.shadowDom&&i?s.remove():BUILD.slotRelocation&&(n["s-cr"]=s,s["s-cn"]=!0))));else if(e&&"style"===e.$tag$){let h=ri(null,s.textContent);h.$elm$=s,h.$index$="0",e.$children$=[h]}},rh=(e,t)=>{if(1===e.nodeType){let r=0;for(;r<e.childNodes.length;r++)rh(e.childNodes[r],t);if(e.shadowRoot)for(r=0;r<e.shadowRoot.childNodes.length;r++)rh(e.shadowRoot.childNodes[r],t)}else if(8===e.nodeType){let i=e.nodeValue.split(".");"o"===i[0]&&(t.set(i[1]+"."+i[2],e),e.nodeValue="",e["s-en"]=i[3])}},ru=(e,t,r)=>{let i=ie.ce(t,r);return e.dispatchEvent(i),i},rp=new WeakMap,rf=(e,t,r,i)=>{let n=rg(t,r),s=r9.get(n);if(!BUILD.attachStyles)return n;if(e=11===e.nodeType?e:r5,s){if("string"==typeof s){let o;e=e.head||e;let a=rp.get(e);if(a||rp.set(e,a=new Set),!a.has(n)){if(BUILD.hydrateClientSide&&e.host&&(o=e.querySelector(`[${t8}="${n}"]`)))o.innerHTML=s;else{if(BUILD.cssVarShim&&ie.$cssShim$){o=ie.$cssShim$.createHostStyle(i,n,s,!!(10&t.$flags$));let l=o["s-sc"];l&&(n=l,a=null)}else(o=r5.createElement("style")).innerHTML=s;(BUILD.hydrateServerSide||BUILD.hotModuleReplacement)&&o.setAttribute(t8,n),e.insertBefore(o,e.querySelector("link"))}a&&a.add(n)}}else BUILD.constructableCSS&&!e.adoptedStyleSheets.includes(s)&&(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s])}return n},rm=e=>{let t=e.$cmpMeta$,r=e.$hostElement$,i=t.$flags$,n=t6("attachStyles",t.$tagName$),s=rf(BUILD.shadowDom&&it&&r.shadowRoot?r.shadowRoot:r.getRootNode(),t,e.$modeName$,r);(BUILD.shadowDom||BUILD.scoped)&&BUILD.cssAnnotations&&10&i&&(r["s-sc"]=s,r.classList.add(s+"-h"),BUILD.scoped&&2&i&&r.classList.add(s+"-s")),n()},rg=(e,t)=>"sc-"+(BUILD.mode&&t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$),rv=(e,t,r,i,n,s)=>{if(r!==i){let o=r2(e,t),a=t.toLowerCase();if(BUILD.vdomClass&&"class"===t){let l=e.classList,d=r_(r),c=r_(i);l.remove(...d.filter(e=>e&&!c.includes(e))),l.add(...c.filter(e=>e&&!d.includes(e)))}else if(BUILD.vdomStyle&&"style"===t){if(BUILD.updatable)for(let h in r)i&&null!=i[h]||(!BUILD.hydrateServerSide&&h.includes("-")?e.style.removeProperty(h):e.style[h]="");for(let u in i)r&&i[u]===r[u]||(!BUILD.hydrateServerSide&&u.includes("-")?e.style.setProperty(u,i[u]):e.style[u]=i[u])}else if(BUILD.vdomKey&&"key"===t);else if(BUILD.vdomRef&&"ref"===t)i&&i(e);else if(!BUILD.vdomListener||(BUILD.lazyLoad?o:e.__lookupSetter__(t))||"o"!==t[0]||"n"!==t[1]){if(BUILD.vdomPropOrAttr){let p=rt(i);if((o||p&&null!==i)&&!n)try{if(e.tagName.includes("-"))e[t]=i;else{let f=null==i?"":i;"list"===t?o=!1:(null==r||e[t]!=f)&&(e[t]=f)}}catch(m){}let g=!1;BUILD.vdomXlink&&a!==(a=a.replace(/^xlink\:?/,""))&&(t=a,g=!0),null==i||!1===i?(!1!==i||""===e.getAttribute(t))&&(BUILD.vdomXlink&&g?e.removeAttributeNS(t7,t):e.removeAttribute(t)):(!o||4&s||n)&&!p&&(i=!0===i?"":i,BUILD.vdomXlink&&g?e.setAttributeNS(t7,t,i):e.setAttribute(t,i))}}else t="-"===t[2]?t.slice(3):r2(r7,a)?a.slice(2):a[2]+t.slice(3),r&&ie.rel(e,t,r,!1),i&&ie.ael(e,t,i,!1)}},ry=/\s/,r_=e=>e?e.split(ry):[],rb=(e,t,r,i)=>{let n=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,s=e&&e.$attrs$||t5,o=t.$attrs$||t5;if(BUILD.updatable)for(i in s)i in o||rv(n,i,s[i],void 0,r,t.$flags$);for(i in o)rv(n,i,s[i],o[i],r,t.$flags$)},rw=(e,t,r,i)=>{let n,l,d;let c=t.$children$[r],h=0;if(BUILD.slotRelocation&&!tQ&&(t1=!0,"slot"===c.$tag$&&(s&&i.classList.add(s+"-s"),c.$flags$|=c.$children$?2:1)),BUILD.isDev&&c.$elm$&&r6(`The JSX ${null!==c.$text$?`"${c.$text$}" text`:`"${c.$tag$}" element`} node should not be shared within the same renderer. The renderer caches element lookups in order to improve performance. However, a side effect from this is that the exact same JSX node should not be reused. For more information please see https://stenciljs.com/docs/templating-jsx#avoid-shared-jsx-nodes`),BUILD.vdomText&&null!==c.$text$)n=c.$elm$=r5.createTextNode(c.$text$);else if(BUILD.slotRelocation&&1&c.$flags$)n=c.$elm$=BUILD.isDebug||BUILD.hydrateServerSide?rE(c):r5.createTextNode("");else{if(BUILD.svg&&!t2&&(t2="svg"===c.$tag$),n=c.$elm$=BUILD.svg?r5.createElementNS(t2?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",BUILD.slotRelocation&&2&c.$flags$?"slot-fb":c.$tag$):r5.createElement(BUILD.slotRelocation&&2&c.$flags$?"slot-fb":c.$tag$),BUILD.svg&&t2&&"foreignObject"===c.$tag$&&(t2=!1),BUILD.vdomAttribute&&rb(null,c,t2),(BUILD.shadowDom||BUILD.scoped)&&re(s)&&n["s-si"]!==s&&n.classList.add(n["s-si"]=s),c.$children$)for(h=0;h<c.$children$.length;++h)(l=rw(e,c,h,n))&&n.appendChild(l);BUILD.svg&&("svg"===c.$tag$?t2=!1:"foreignObject"===n.tagName&&(t2=!0))}return BUILD.slotRelocation&&(n["s-hn"]=a,3&c.$flags$&&(n["s-sr"]=!0,n["s-cr"]=o,n["s-sn"]=c.$name$||"",(d=e&&e.$children$&&e.$children$[r])&&d.$tag$===c.$tag$&&e.$elm$&&r$(e.$elm$,!1))),n},r$=(e,t)=>{ie.$flags$|=1;let r=e.childNodes;for(let i=r.length-1;i>=0;i--){let n=r[i];n["s-hn"]!==a&&n["s-ol"]&&(rU(n).insertBefore(n,rx(n)),n["s-ol"].remove(),n["s-ol"]=void 0,t1=!0),t&&r$(n,t)}ie.$flags$&=-2},rI=(e,t,r,i,n,s)=>{let o,l=BUILD.slotRelocation&&e["s-cr"]&&e["s-cr"].parentNode||e;for(BUILD.shadowDom&&l.shadowRoot&&l.tagName===a&&(l=l.shadowRoot);n<=s;++n)i[n]&&(o=rw(null,r,n,e))&&(i[n].$elm$=o,l.insertBefore(o,BUILD.slotRelocation?rx(t):t))},rS=(e,t,r,i,n)=>{for(;t<=r;++t)(i=e[t])&&(n=i.$elm$,rO(i),BUILD.slotRelocation&&(t0=!0,n["s-ol"]?n["s-ol"].remove():r$(n,!0)),n.remove())},rk=(e,t,r,i)=>{let n,s,o=0,a=0,l=0,d=0,c=t.length-1,h=t[0],u=t[c],p=i.length-1,f=i[0],m=i[p];for(;o<=c&&a<=p;)if(null==h)h=t[++o];else if(null==u)u=t[--c];else if(null==f)f=i[++a];else if(null==m)m=i[--p];else if(rA(h,f))rD(h,f),h=t[++o],f=i[++a];else if(rA(u,m))rD(u,m),u=t[--c],m=i[--p];else if(rA(h,m))BUILD.slotRelocation&&("slot"===h.$tag$||"slot"===m.$tag$)&&r$(h.$elm$.parentNode,!1),rD(h,m),e.insertBefore(h.$elm$,u.$elm$.nextSibling),h=t[++o],m=i[--p];else if(rA(u,f))BUILD.slotRelocation&&("slot"===h.$tag$||"slot"===m.$tag$)&&r$(u.$elm$.parentNode,!1),rD(u,f),e.insertBefore(u.$elm$,h.$elm$),u=t[--c],f=i[++a];else{if(l=-1,BUILD.vdomKey){for(d=o;d<=c;++d)if(t[d]&&null!==t[d].$key$&&t[d].$key$===f.$key$){l=d;break}}BUILD.vdomKey&&l>=0?((s=t[l]).$tag$!==f.$tag$?n=rw(t&&t[a],r,l,e):(rD(s,f),t[l]=void 0,n=s.$elm$),f=i[++a]):(n=rw(t&&t[a],r,a,e),f=i[++a]),n&&(BUILD.slotRelocation?rU(h.$elm$).insertBefore(n,rx(h.$elm$)):h.$elm$.parentNode.insertBefore(n,h.$elm$))}o>c?rI(e,null==i[p+1]?null:i[p+1].$elm$,r,i,a,p):BUILD.updatable&&a>p&&rS(t,o,c)},rA=(e,t)=>e.$tag$===t.$tag$&&(BUILD.slotRelocation&&"slot"===e.$tag$?e.$name$===t.$name$:!BUILD.vdomKey||e.$key$===t.$key$),rx=e=>e&&e["s-ol"]||e,rU=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,rD=(e,t)=>{let r;let i=t.$elm$=e.$elm$,n=e.$children$,s=t.$children$,o=t.$tag$,a=t.$text$;BUILD.vdomText&&null!==a?BUILD.vdomText&&BUILD.slotRelocation&&(r=i["s-cr"])?r.parentNode.textContent=a:BUILD.vdomText&&e.$text$!==a&&(i.data=a):(BUILD.svg&&(t2="svg"===o||"foreignObject"!==o&&t2),(BUILD.vdomAttribute||BUILD.reflect)&&(BUILD.slot&&"slot"===o||rb(e,t,t2)),BUILD.updatable&&null!==n&&null!==s?rk(i,n,t,s):null!==s?(BUILD.updatable&&BUILD.vdomText&&null!==e.$text$&&(i.textContent=""),rI(i,null,t,s,0,s.length-1)):BUILD.updatable&&null!==n&&rS(n,0,n.length-1),BUILD.svg&&t2&&"svg"===o&&(t2=!1))},rT=e=>{let t,r,i,n,s,o;let a=e.childNodes;for(r=0,i=a.length;r<i;r++)if(1===(t=a[r]).nodeType){if(t["s-sr"]){for(n=0,s=t["s-sn"],t.hidden=!1;n<i;n++)if(o=a[n].nodeType,a[n]["s-hn"]!==t["s-hn"]||""!==s){if(1===o&&s===a[n].getAttribute("slot")){t.hidden=!0;break}}else if(1===o||3===o&&""!==a[n].textContent.trim()){t.hidden=!0;break}}rT(t)}},rL=null,rC=e=>{let t,r,i,n,s,o;let a=0,l=e.childNodes,d=l.length;for(;a<d;a++){if((t=l[a])["s-sr"]&&(r=t["s-cr"])&&r.parentNode)for(i=r.parentNode.childNodes,n=t["s-sn"],o=i.length-1;o>=0;o--)(r=i[o])["s-cn"]||r["s-nr"]||r["s-hn"]===t["s-hn"]||(rR(r,n)?(s=rL.find(e=>e.$nodeToRelocate$===r),t0=!0,r["s-sn"]=r["s-sn"]||n,s?s.$slotRefNode$=t:rL.push({$slotRefNode$:t,$nodeToRelocate$:r}),r["s-sr"]&&rL.map(e=>{rR(e.$nodeToRelocate$,r["s-sn"])&&(s=rL.find(e=>e.$nodeToRelocate$===r))&&!e.$slotRefNode$&&(e.$slotRefNode$=s.$slotRefNode$)})):rL.some(e=>e.$nodeToRelocate$===r)||rL.push({$nodeToRelocate$:r}));1===t.nodeType&&rC(t)}},rR=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,rO=e=>{BUILD.vdomRef&&(e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(rO))},rN=(e,t)=>{let r=e.$hostElement$,i=e.$cmpMeta$,n=e.$vnode$||ri(null,null),l=rs(t)?t:rr(null,null,t);if(a=r.tagName,BUILD.isDev&&Array.isArray(t)&&t.some(rs))throw Error(`The <Host> must be the single root component.
Looks like the render() function of "${a.toLowerCase()}" is returning an array that contains the <Host>.

The render() function should look like this instead:

render() {
  // Do not return an array
  return (
    <Host>{content}</Host>
  );
}
  `);if(BUILD.reflect&&i.$attrsToReflect$&&(l.$attrs$=l.$attrs$||{},i.$attrsToReflect$.map(([e,t])=>l.$attrs$[t]=r[e])),l.$tag$=null,l.$flags$|=4,e.$vnode$=l,l.$elm$=n.$elm$=BUILD.shadowDom&&r.shadowRoot||r,(BUILD.scoped||BUILD.shadowDom)&&(s=r["s-sc"]),BUILD.slotRelocation&&(o=r["s-cr"],tQ=it&&(1&i.$flags$)!=0,t0=!1),rD(n,l),BUILD.slotRelocation){if(ie.$flags$|=1,t1){let d,c,h,u,p,f;rC(l.$elm$);let m=0;for(;m<rL.length;m++)(c=(d=rL[m]).$nodeToRelocate$)["s-ol"]||((h=BUILD.isDebug||BUILD.hydrateServerSide?rP(c):r5.createTextNode(""))["s-nr"]=c,c.parentNode.insertBefore(c["s-ol"]=h,c));for(m=0;m<rL.length;m++)if(c=(d=rL[m]).$nodeToRelocate$,d.$slotRefNode$){for(u=d.$slotRefNode$.parentNode,p=d.$slotRefNode$.nextSibling,h=c["s-ol"];h=h.previousSibling;)if((f=h["s-nr"])&&f["s-sn"]===c["s-sn"]&&u===f.parentNode&&(!(f=f.nextSibling)||!f["s-nr"])){p=f;break}(p||u===c.parentNode)&&c.nextSibling===p||c===p||(!c["s-hn"]&&c["s-ol"]&&(c["s-hn"]=c["s-ol"].parentNode.nodeName),u.insertBefore(c,p))}else 1===c.nodeType&&(c.hidden=!0)}t0&&rT(l.$elm$),ie.$flags$&=-2,rL.length=0}},rE=e=>r5.createComment(`<slot${e.$name$?' name="'+e.$name$+'"':""}> (host=${a.toLowerCase()})`),rP=e=>r5.createComment("org-location for "+(e.localName?`<${e.localName}> (host=${e["s-hn"]})`:`[${e.textContent}]`)),rB=(e,t)=>{BUILD.asyncLoading&&t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise(t=>e.$onRenderResolve$=t))},rj=(e,t)=>{if(BUILD.taskQueue&&BUILD.updatable&&(e.$flags$|=16),BUILD.asyncLoading&&4&e.$flags$){e.$flags$|=512;return}rB(e,e.$ancestorComponent$);let r=()=>rF(e,t);return BUILD.taskQueue?id(r):r()},rF=(e,t)=>{let r;let i=e.$hostElement$,n=t6("scheduleUpdate",e.$cmpMeta$.$tagName$),s=BUILD.lazyLoad?e.$lazyInstance$:i;return t?(BUILD.lazyLoad&&BUILD.hostListener&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map(([e,t])=>rH(s,e,t)),e.$queuedListeners$=null)),rG(i,"componentWillLoad"),BUILD.cmpWillLoad&&(r=rH(s,"componentWillLoad"))):(rG(i,"componentWillUpdate"),BUILD.cmpWillUpdate&&(r=rH(s,"componentWillUpdate"))),rG(i,"componentWillRender"),BUILD.cmpWillRender&&(r=rW(r,()=>rH(s,"componentWillRender"))),n(),rW(r,()=>rM(e,s,t))},rM=async(e,t,r)=>{let i=e.$hostElement$,n=t6("update",e.$cmpMeta$.$tagName$),s=i["s-rc"];BUILD.style&&r&&rm(e);let o=t6("render",e.$cmpMeta$.$tagName$);if(BUILD.isDev&&(e.$flags$|=1024),BUILD.hydrateServerSide?await rq(e,t,i):rq(e,t,i),BUILD.cssVarShim&&ie.$cssShim$&&ie.$cssShim$.updateHost(i),BUILD.isDev&&(e.$renderCount$++,e.$flags$&=-1025),BUILD.hydrateServerSide)try{rJ(i),r&&(1&e.$cmpMeta$.$flags$?i["s-en"]="":2&e.$cmpMeta$.$flags$&&(i["s-en"]="c"))}catch(a){r4(a,i)}if(BUILD.asyncLoading&&s&&(s.map(e=>e()),i["s-rc"]=void 0),o(),n(),BUILD.asyncLoading){let l=i["s-p"],d=()=>rV(e);0===l.length?d():(Promise.all(l).then(d),e.$flags$|=4,l.length=0)}else rV(e)},rq=(e,t,r)=>{let i=!!BUILD.allRenderFn,n=!!BUILD.lazyLoad,s=!!BUILD.taskQueue,o=!!BUILD.updatable;try{if(t=i?t.render():t.render&&t.render(),o&&s&&(e.$flags$&=-17),(o||n)&&(e.$flags$|=2),BUILD.hasRenderFn||BUILD.reflect){if(BUILD.vdomRender||BUILD.reflect){if(BUILD.hydrateServerSide)return Promise.resolve(t).then(t=>rN(e,t));rN(e,t)}else r.textContent=t}}catch(a){r4(a,e.$hostElement$)}return null},rV=e=>{let t=e.$cmpMeta$.$tagName$,r=e.$hostElement$,i=t6("postUpdate",t),n=BUILD.lazyLoad?e.$lazyInstance$:r,s=e.$ancestorComponent$;BUILD.cmpDidRender&&(BUILD.isDev&&(e.$flags$|=1024),rH(n,"componentDidRender"),BUILD.isDev&&(e.$flags$&=-1025)),rG(r,"componentDidRender"),64&e.$flags$?(BUILD.cmpDidUpdate&&(BUILD.isDev&&(e.$flags$|=1024),rH(n,"componentDidUpdate"),BUILD.isDev&&(e.$flags$&=-1025)),rG(r,"componentDidUpdate"),i()):(e.$flags$|=64,BUILD.asyncLoading&&BUILD.cssAnnotations&&rZ(r),BUILD.cmpDidLoad&&(BUILD.isDev&&(e.$flags$|=2048),rH(n,"componentDidLoad"),BUILD.isDev&&(e.$flags$&=-2049)),rG(r,"componentDidLoad"),i(),BUILD.asyncLoading&&(e.$onReadyResolve$(r),s||rz(t))),BUILD.hotModuleReplacement&&r["s-hmr-load"]&&r["s-hmr-load"](),BUILD.method&&BUILD.lazyLoad&&e.$onInstanceResolve$(r),BUILD.asyncLoading&&(e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),512&e.$flags$&&il(()=>rj(e,!1)),e.$flags$&=-517)},rz=e=>{BUILD.cssAnnotations&&rZ(r5.documentElement),BUILD.asyncQueue&&(ie.$flags$|=2),il(()=>ru(r7,"appload",{detail:{namespace:NAMESPACE}})),BUILD.profile&&performance.measure&&performance.measure(`[Stencil] ${NAMESPACE} initial load (by ${e})`,"st:app:start")},rH=(e,t,r)=>{if(e&&e[t])try{return e[t](r)}catch(i){r4(i)}},rW=(e,t)=>e&&e.then?e.then(t):t(),rG=(e,t)=>{BUILD.lifecycleDOMEvents&&ru(e,"stencil_"+t,{bubbles:!0,composed:!0,detail:{namespace:NAMESPACE}})},rZ=e=>BUILD.hydratedClass?e.classList.add("hydrated"):BUILD.hydratedAttribute?e.setAttribute("hydrated",""):void 0,rJ=e=>{let t=e.children;if(null!=t)for(let r=0,i=t.length;r<i;r++){let n=t[r];"function"==typeof n.connectedCallback&&n.connectedCallback(),rJ(n)}},rY=(e,t)=>{let r,i=0;for(;i<e.length;i++)if((r=e[i])["s-sr"]&&r["s-sn"]===t||(r=rY(r.childNodes,t)))return r;return null},rX=(e,t,r,i)=>{null!=t&&(null!=t["s-nr"]&&i.push(t),1===t.nodeType&&t.childNodes.forEach(t=>{let n=r1(t);null==n||r.staticComponents.has(t.nodeName.toLowerCase())||rK(e,t,n.$vnode$,r,{nodeIds:0}),rX(e,t,r,i)}))},rK=(e,t,r,i,n)=>{if(null!=r){let s=++i.hostIds;if(t.setAttribute("s-id",s),null!=t["s-cr"]&&(t["s-cr"].nodeValue=`r.${s}`),null!=r.$children$&&r.$children$.forEach((t,r)=>{rQ(e,t,n,s,0,r)}),t&&r&&r.$elm$&&!t.hasAttribute("c-id")){let o=t.parentElement;if(o&&o.childNodes){let a=Array.from(o.childNodes),l=a.find(e=>8===e.nodeType&&e["s-sr"]);if(l){let d=a.indexOf(t)-1;r.$elm$.setAttribute(t9,`${l["s-host-id"]}.${l["s-node-id"]}.0.${d}`)}}}}},rQ=(e,t,r,i,n,s)=>{let o=t.$elm$;if(null==o)return;let a=r.nodeIds++,l=`${i}.${a}.${n}.${s}`;if(o["s-host-id"]=i,o["s-node-id"]=a,1===o.nodeType)o.setAttribute(t9,l);else if(3===o.nodeType){let d=o.parentNode,c=d.nodeName;if("STYLE"!==c&&"SCRIPT"!==c){let h=`t.${l}`,u=e.createComment(h);d.insertBefore(u,o)}}else if(8===o.nodeType&&o["s-sr"]){let p=o["s-sn"]||"",f=`s.${l}.${p}`;o.nodeValue=f}if(null!=t.$children$){let m=n+1;t.$children$.forEach((t,n)=>{rQ(e,t,r,i,m,n)})}},r0=new WeakMap,r1=e=>r0.get(e),r2=(e,t)=>t in e,r4=(e,t)=>(l||console.error)(e,t),r3=tX.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],r6=(...e)=>console.error(...r3,...e),r8=(...e)=>console.warn(...r3,...e),r9=new Map,r7="undefined"!=typeof window?window:{};tX.cssVarShim&&r7.CSS;let r5=r7.document||{head:{}};r7.HTMLElement;let ie={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,r,i)=>e.addEventListener(t,r,i),rel:(e,t,r,i)=>e.removeEventListener(t,r,i),ce:(e,t)=>new CustomEvent(e,t)},it=!tX.shadowDomShim||!tX.shadowDom||(r5.head.attachShadow+"").indexOf("[native")>-1,ir=e=>Promise.resolve(e);tX.constructableCSS;let ii=null,is=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(r){r4(r)}e.length=0},io=(e,t)=>{let r=0,i=0;for(;r<e.length&&(i=performance.now())<t;)try{e[r++](i)}catch(n){r4(n)}r===e.length?e.length=0:0!==r&&e.splice(0,r)},ia=()=>{if(BUILD.asyncQueue&&t4++,is(null),BUILD.asyncQueue){let e=(6&ie.$flags$)==2?performance.now()+14*Math.ceil(.1*t4):1/0;io(ii,e),io(null,e),ii.length>0&&(null.push(...ii),ii.length=0),null.length+ii.length+null.length>0?ie.raf(ia):t4=0}else is(ii),null.length>0&&ie.raf(ia)},il=e=>ir().then(e),id=null;/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */ function ic(){let{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>e.contains("calcite-theme-dark")||e.contains("calcite-theme-auto")&&t?"dark":"light",i=e=>document.body.dispatchEvent(new CustomEvent("calciteThemeChange",{bubbles:!0,detail:{theme:e}})),n=e=>{s!==e&&i(e),s=e},s=r();i(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>n(e.matches?"dark":"light")),new MutationObserver(()=>n(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}!function(){let e="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;e&&("interactive"===document.readyState?ic():document.addEventListener("DOMContentLoaded",()=>ic(),{once:!0}))}();let ih=Symbol("widget"),iu=[],ip={},im=new WeakMap;function ig(e,t,r,{parentWidget:i,widgetConstructor:n,widgetProperties:s}){let o=new n(s);o.container=e,im.set(e,o),o.afterCreate?.(o,e),i._internalHandles.add((0,b.kB)(()=>iy(e)))}function iv(e,t,r,{widgetProperties:i}){let n=im.get(e);n&&(n.set(i),n.afterUpdate?.(n,e))}function iy(e){let t=im.get(e);t&&(t.destroy(),im.delete(e))}function i_(e){return"function"==typeof e&&e[ih]}let ib=new Set,iw=0,i$={widgetIcon:"esri-icon-checkbox-unchecked"},iI=(e=>{let t;let r={...tH,...e},i=tG(r),n=i.performanceLogger,s,o=!0,a=!1,l=[],d=[],c=(e,s,o)=>{let a;i.eventHandlerInterceptor=(e,i,s,o)=>function(e){let i,s;n("domEvent",e);let o=tZ(e.currentTarget,a.domNode),l=o.some(e=>customElements.get(e?.tagName?.toLowerCase()));if(e.eventPhase!==Event.CAPTURING_PHASE&&l){let d=e.composedPath(),c=d.slice(d.indexOf(e.currentTarget),d.indexOf(a.domNode)).filter(e=>e.getRootNode()===e.ownerDocument).reverse();i=tY(a.getLastRender(),c,!0)}else o.reverse(),i=tY(a.getLastRender(),o);return i&&(s=r.handleInterceptedEvent(t,i,this,e)),n("domEventProcessed",e),s},r.postProcessProjectionOptions?.(i);let c=o();a=e(s,c,i),l.push(a),d.push(o),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(a,c)},h=()=>{if(s=void 0,o){o=!1,n("renderStart",void 0);for(let e=0;e<l.length;e++){let t=d[e]();n("rendered",void 0),l[e].update(t),n("patched",void 0)}n("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(h=r.modifyDoRenderImplementation(h,l,d)),t={renderNow:h,scheduleRender(){s||a||(s=requestAnimationFrame(h))},stop(){s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume(){a=!1,o=!0,t.scheduleRender()},append(e,t){c(tz.append,e,t)},insertBefore(e,t){c(tz.insertBefore,e,t)},merge(e,t){c(tz.merge,e,t)},replace(e,t){c(tz.replace,e,t)},detach(e){for(let t=0;t<d.length;t++)if(d[t]===e)return d.splice(t,1),l.splice(t,1)[0];throw Error("renderFunction was not found")}}})({postProcessProjectionOptions(e){let t=e.eventHandlerInterceptor,r=/capture$/i;e.eventHandlerInterceptor=(e,i,n,s)=>{let o=t?.(e,i,n,s),a=r.test(e);if(!((e=e.replace(r,"")).toLowerCase() in n)||a){let l=e[2].toLowerCase()+e.slice(3),d=e=>o?.call(n,e);n.addEventListener(l,d,a);let c=()=>n.removeEventListener(l,d,a),h=s.afterRemoved;s.afterRemoved=e=>{h?.(e),c()}}return o}},handleInterceptedEvent(e,t,r,i){let{eventPhase:n,type:s}=i,o=n===Event.CAPTURING_PHASE,a=`on${s}${o?"capture":""}`,l=t.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(td.clear(),e.scheduleRender(),l[a].call(l.bind||r,i))}}),iS=!1,ik=class extends ek(I.EventedAccessor){constructor(e,t){var r;super(e,t),this._attached=!1,this._internalHandles=new eI.Z,this._projector=iI,this._readyForTrueRender=!1,this.iconClass=i$.widgetIcon,this.key=this,this._loadLocale=(0,x.Ds)(async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){let e=await (0,x.as)(this._messageBundleProps.map(async({bundlePath:e,propertyName:t})=>{let r=await ef(e);this.uiStrings&&Object.keys(this.uiStrings)&&(r=function e(t,r){for(let i in r)null!=t[i]&&("object"==typeof t[i]&&"object"==typeof r[i]?e(t[i],r?.[i]):t[i]=r[i]);return t}((0,k.d9)(r),this.uiStrings)),this[t]=r}));for(let t of e)t.error&&P.Z.getLogger(this.declaredClass).error("widget-intl:locale-error",this.declaredClass,t.error)}await this.loadLocale()}),t3((0,N.hF)(e$("components/assets")));let i="esri-widget-uid-"+function(){if(ex)return crypto.randomUUID();let e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;let t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}(),n=this.render.bind(this);this._trackingTarget=new eT.M(()=>this.scheduleRender());let s=()=>{if(!this._readyForTrueRender||this.destroyed)return null;if(!this.visible)return{vnodeSelector:"div",properties:{key:i,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0};let e=n(),{properties:t}=e;t||(e.properties=t={});let{key:r,styles:s}=t;r||(t.key=i),s||(t.styles=s={}),s.display||(s.display="");let o=0;return e.children?.forEach(e=>{if(i_(e.vnodeSelector))return;let{properties:t}=e;t||(e.properties=t={}),t.key||(t.key=`${this.id}--${o++}`)}),function e(t,r){let i=r.children;if(i&&i.length)for(let n=0;n<i.length;++n)i[n]=e(t,i[n]);else i=iu;let s=r.vnodeSelector;if(i_(s)){let o=r.properties||ip,a=o.key||s;return{vnodeSelector:"div",properties:{key:a,afterCreate:ig,afterUpdate:iv,afterRemoved:iy,parentWidget:t,widgetConstructor:s,widgetProperties:{...o,key:a,children:i}},children:void 0,text:void 0,domNode:null}}return r}(this,e)};this.render=()=>{var e;if(iS)return s();let t=td.get(this)??null;if(t)return t;this._trackingTarget.clear(),iS=!0;try{t=(0,eD.LJ)(this._trackingTarget,s)}catch(r){throw console.error(r),r}finally{iS=!1}return t&&(e=t,td.set(this,e)),t},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then(()=>{this._readyForTrueRender=!0,this._postInitialize()})),r=this._resourcesFetch,ib.add(r),r.finally(()=>ib.delete(r))}normalizeCtorArgs(e,t){let r={...e};return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then(()=>{}).catch(x.H9)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||((0,U.SC)(this._trackingTarget),(0,U.SC)(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,tc(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return"string"==typeof e?document.getElementById(e):e??null}get domNode(){return this.container}set domNode(e){this.container=e}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+iw++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get test(){return{projector:this._projector}}render(){throw Error("not implemented")}scheduleRender(){this.destroyed||(tc(this),this._projector.scheduleRender())}classes(...e){return tu.apply(this,e)}renderNow(){tc(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this._internalHandles.add(T(()=>this.viewModel,(e,t)=>{t&&this._internalHandles.remove("delegated-events"),e&&(0,S.vT)(e)&&this._internalHandles.add(this._delegatedEventNames.map(t=>(0,S.on)(e,t,e=>{this.emit(t,e)})),"delegated-events")},O)),this.postInitialize();let e=async()=>{await this._loadLocale().catch(x.H9),this.scheduleRender()};this._internalHandles.add([(V.push(e),{remove(){V.splice(V.indexOf(e),1)}}),T(()=>this.uiStrings,e),function(e,t,r={}){return L(e,t,r,R)}(()=>this.container,e=>{this.destroyed||this._attach(e)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}};ik[ih]=!0,(0,m._)([(0,E.Cb)()],ik.prototype,"_readyForTrueRender",void 0),(0,m._)([(0,E.Cb)({value:null})],ik.prototype,"container",null),(0,m._)([(0,eU.p)("container")],ik.prototype,"castContainer",null),(0,m._)([(0,E.Cb)()],ik.prototype,"domNode",null),(0,m._)([(0,E.Cb)()],ik.prototype,"iconClass",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"id",null),(0,m._)([(0,E.Cb)()],ik.prototype,"label",null),(0,m._)([(0,E.Cb)()],ik.prototype,"renderable",null),(0,m._)([(0,E.Cb)()],ik.prototype,"uiStrings",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"viewModel",void 0),(0,m._)([(0,E.Cb)({value:!0})],ik.prototype,"visible",null),(0,m._)([(0,E.Cb)()],ik.prototype,"key",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"children",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"afterCreate",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"afterUpdate",void 0),(0,m._)([(0,E.Cb)()],ik.prototype,"afterRemoved",void 0),ik=(0,m._)([(0,w.j)("esri.widgets.Widget")],ik);let iA=ik;function ix(e){return(t,r)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}var iU=function(e,t){for(var r=0,i=e.length;r<i;r++){var n=e[r];Array.isArray(n)?iU(n,t):null!=n&&!1!==n&&(n.hasOwnProperty("vnodeSelector")||(n={vnodeSelector:"",properties:void 0,children:void 0,text:n.toString(),domNode:null}),t.push(n))}},iD=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(1===r.length&&"string"==typeof r[0])return{vnodeSelector:e,properties:t||void 0,children:void 0,text:r[0],domNode:null};var n=[];return iU(r,n),{vnodeSelector:e,properties:t||void 0,children:n,text:void 0,domNode:null}};function iT(e,t,...r){return"function"!=typeof e||i_(e)?iD(e,t,...r):e(t,...r)}let iL={base:"esri-identity-form",group:"esri-identity-form__group",label:"esri-identity-form__label",footer:"esri-identity-form__footer",esriInput:"esri-input",esriButton:"esri-button",esriButtonSecondary:"esri-button--secondary"},iC=class extends iA{constructor(e,t){super(e,t),this._usernameInputNode=null,this._passwordInputNode=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){let{error:e,server:t,resource:r,signingIn:i,oAuthPrompt:n,messages:s}=this,o=iT("div",{class:iL.group},function(e,t,r={}){let{format:i={}}=r;return(0,B.gx)(e,e=>(function(e,t,r){let i,n;let s=e.indexOf(":");if(-1===s?i=e.trim():(i=e.slice(0,s).trim(),n=e.slice(s+1).trim()),!i)return"";let o=(0,A.hS)(i,t);if(null==o)return"";let a=(n?r?.[n]:null)??r?.[i];return a?function(e,t){switch(t.type){case"date":return ei(e,t.intlOptions);case"number":return ea(e,t.intlOptions);default:return el.warn("missing format descriptor for key {key}"),ed(e)}}(o,a):n?function(e,t){switch(t.toLowerCase()){case"dateformat":return ei(e);case"numberformat":return ea(e);default:return el.warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?ei(e):/^numberformat/i.test(t)?ea(e):ed(e)}}(o,n):ed(o)})(e,t,i))}(n?s.oAuthInfo:s.info,{server:t&&/\.arcgis\.com/i.test(t)?"ArcGIS Online":t,resource:`(${r||s.lblItem})`})),a=n?null:iT("div",{class:iL.group,key:"username"},iT("label",{class:iL.label},s.lblUser,iT("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:tp,"data-node-ref":"_usernameInputNode",class:iL.esriInput}))),l=n?null:iT("div",{class:iL.group,key:"password"},iT("label",{class:iL.label},s.lblPwd,iT("input",{value:"",required:!0,type:"password",bind:this,afterCreate:tp,"data-node-ref":"_passwordInputNode",class:iL.esriInput}))),d=iT("div",{class:this.classes(iL.group,iL.footer)},iT("input",{type:"submit",disabled:!!i,value:i?s.lblSigning:s.lblOk,class:iL.esriButton}),iT("input",{type:"button",value:s.lblCancel,bind:this,onclick:this._cancel,class:this.classes(iL.esriButton,iL.esriButtonSecondary)})),c=e?iT("div",null,e.details&&e.details.httpStatus?s.invalidUser:s.noAuthService):null;return iT("form",{class:iL.base,bind:this,onsubmit:this._submit},o,c,a,l,d)}_cancel(){this._set("signingIn",!1),this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(e){e.preventDefault(),this._set("signingIn",!0);let t=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit("submit",t)}};(0,m._)([(0,E.Cb)(),ix("esri/identity/t9n/identity")],iC.prototype,"messages",void 0),(0,m._)([(0,E.Cb)()],iC.prototype,"signingIn",void 0),(0,m._)([(0,E.Cb)()],iC.prototype,"server",void 0),(0,m._)([(0,E.Cb)()],iC.prototype,"resource",void 0),(0,m._)([(0,E.Cb)()],iC.prototype,"error",void 0),(0,m._)([(0,E.Cb)()],iC.prototype,"oAuthPrompt",void 0),iC=(0,m._)([(0,w.j)("esri.identity.IdentityForm")],iC);let iR=iC;/*!
* tabbable 6.0.1
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/ var iO=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],iN=iO.join(","),iE="undefined"==typeof Element,iP=iE?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,iB=!iE&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},ij=function(e,t,r){var i=Array.prototype.slice.apply(e.querySelectorAll(iN));return t&&iP.call(e,iN)&&i.unshift(e),i=i.filter(r)},iF=function e(t,r,i){for(var n=[],s=Array.from(t);s.length;){var o=s.shift();if("SLOT"===o.tagName){var a=o.assignedElements(),l=e(a.length?a:o.children,!0,i);i.flatten?n.push.apply(n,l):n.push({scopeParent:o,candidates:l})}else{iP.call(o,iN)&&i.filter(o)&&(r||!t.includes(o))&&n.push(o);var d=o.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(o),c=!i.shadowRootFilter||i.shadowRootFilter(o);if(d&&c){var h=e(!0===d?o.children:d.children,!0,i);i.flatten?n.push.apply(n,h):n.push({scopeParent:o,candidates:h})}else s.unshift.apply(s,o.children)}}return n},iM=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},iq=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},iV=function(e){return"INPUT"===e.tagName},iz=function(e,t){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===t)return e[r]},iH=function(e){if(!e.name)return!0;var t,r=e.form||iB(e),i=function(e){return r.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=i(window.CSS.escape(e.name));else try{t=i(e.name)}catch(n){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",n.message),!1}var s=iz(t,e.form);return!s||s===e},iW=function(e){for(var t,r,i=iB(e).host,n=!!(null!==(t=i)&&void 0!==t&&t.ownerDocument.contains(i)||e.ownerDocument.contains(e));!n&&i;)n=!!(null!==(r=i=iB(i).host)&&void 0!==r&&r.ownerDocument.contains(i));return n},iG=function(e){var t=e.getBoundingClientRect(),r=t.width,i=t.height;return 0===r&&0===i},iZ=function(e,t){var r=t.displayCheck,i=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var n=iP.call(e,"details>summary:first-of-type")?e.parentElement:e;if(iP.call(n,"details:not([open]) *"))return!0;if(r&&"full"!==r&&"legacy-full"!==r){if("non-zero-area"===r)return iG(e)}else{if("function"==typeof i){for(var s=e;e;){var o=e.parentElement,a=iB(e);if(o&&!o.shadowRoot&&!0===i(o))return iG(e);e=e.assignedSlot?e.assignedSlot:o||a===e.ownerDocument?o:a.host}e=s}if(iW(e))return!e.getClientRects().length;if("legacy-full"!==r)return!0}return!1},iJ=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var r=0;r<t.children.length;r++){var i=t.children.item(r);if("LEGEND"===i.tagName)return!!iP.call(t,"fieldset[disabled] *")||!i.contains(e)}return!0}t=t.parentElement}return!1},iY=function(e,t){return!(t.disabled||iV(t)&&"hidden"===t.type||iZ(t,e)||"DETAILS"===t.tagName&&Array.prototype.slice.apply(t.children).some(function(e){return"SUMMARY"===e.tagName})||iJ(t))},iX=function(e,t){var r;return!(iV(r=t)&&"radio"===r.type&&!iH(r)||0>iM(t))&&!!iY(e,t)},iK=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!isNaN(t)||t>=0},iQ=function e(t){var r=[],i=[];return t.forEach(function(t,n){var s=!!t.scopeParent,o=s?t.scopeParent:t,a=iM(o,s),l=s?e(t.candidates):o;0===a?s?r.push.apply(r,l):r.push(o):i.push({documentOrder:n,tabIndex:a,item:t,isScope:s,content:l})}),i.sort(iq).reduce(function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e},[]).concat(r)},i0=function(e,t){if(t=t||{},!e)throw Error("No node provided");return!1!==iP.call(e,iN)&&iX(t,e)},i1=iO.concat("iframe").join(","),i2=function(e,t){if(t=t||{},!e)throw Error("No node provided");return!1!==iP.call(e,i1)&&iY(t,e)};/*!
* focus-trap 7.0.0
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/ function i4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function i3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i4(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t],t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i4(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var i6=(h=[],{activateTrap:function(e){if(h.length>0){var t=h[h.length-1];t!==e&&t.pause()}var r=h.indexOf(e);-1===r||h.splice(r,1),h.push(e)},deactivateTrap:function(e){var t=h.indexOf(e);-1!==t&&h.splice(t,1),h.length>0&&h[h.length-1].unpause()}}),i8=function(e){return setTimeout(e,0)},i9=function(e,t){var r=-1;return e.every(function(e,i){return!t(e)||(r=i,!1)}),r},i7=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return"function"==typeof e?e.apply(void 0,r):e},i5=function(e){return e.target.shadowRoot&&"function"==typeof e.composedPath?e.composedPath()[0]:e.target},ne=function(e,t){var r,i=(null==t?void 0:t.document)||document,n=i3({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},t),s={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},o=function(e,t,r){return e&&void 0!==e[t]?e[t]:n[r||t]},a=function(e){return s.containerGroups.findIndex(function(t){var r=t.container,i=t.tabbableNodes;return r.contains(e)||i.find(function(t){return t===e})})},l=function(e){var t=n[e];if("function"==typeof t){for(var r=arguments.length,s=Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];t=t.apply(void 0,s)}if(!0===t&&(t=void 0),!t){if(void 0===t||!1===t)return t;throw Error("`".concat(e,"` was specified but was not a node, or did not return a node"))}var a=t;if("string"==typeof t&&!(a=i.querySelector(t)))throw Error("`".concat(e,"` as selector refers to no known node"));return a},d=function(){var e=l("initialFocus");if(!1===e)return!1;if(void 0===e){if(a(i.activeElement)>=0)e=i.activeElement;else{var t=s.tabbableGroups[0];e=t&&t.firstTabbableNode||l("fallbackFocus")}}if(!e)throw Error("Your focus-trap needs to have at least one focusable element");return e},c=function(){if(s.containerGroups=s.containers.map(function(e){var t,r,i,s,o=(t=e,iQ((r=(r=n.tabbableOptions)||{}).getShadowRoot?iF([t],r.includeContainer,{filter:iX.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:iK}):ij(t,r.includeContainer,iX.bind(null,r)))),a=(i=e,(s=(s=n.tabbableOptions)||{}).getShadowRoot?iF([i],s.includeContainer,{filter:iY.bind(null,s),flatten:!0,getShadowRoot:s.getShadowRoot}):ij(i,s.includeContainer,iY.bind(null,s)));return{container:e,tabbableNodes:o,focusableNodes:a,firstTabbableNode:o.length>0?o[0]:null,lastTabbableNode:o.length>0?o[o.length-1]:null,nextTabbableNode:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=a.findIndex(function(t){return t===e});return r<0?void 0:t?a.slice(r+1).find(function(e){return i0(e,n.tabbableOptions)}):a.slice(0,r).reverse().find(function(e){return i0(e,n.tabbableOptions)})}}}),s.tabbableGroups=s.containerGroups.filter(function(e){return e.tabbableNodes.length>0}),s.tabbableGroups.length<=0&&!l("fallbackFocus"))throw Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},h=function e(t){if(!1!==t&&t!==i.activeElement){if(!t||!t.focus){e(d());return}t.focus({preventScroll:!!n.preventScroll}),s.mostRecentlyFocusedNode=t,t.tagName&&"input"===t.tagName.toLowerCase()&&"function"==typeof t.select&&t.select()}},u=function(e){var t=l("setReturnFocus",e);return t||!1!==t&&e},p=function(e){var t=i5(e);if(!(a(t)>=0)){if(i7(n.clickOutsideDeactivates,e)){r.deactivate({returnFocus:n.returnFocusOnDeactivate&&!i2(t,n.tabbableOptions)});return}i7(n.allowOutsideClick,e)||e.preventDefault()}},f=function(e){var t=i5(e),r=a(t)>=0;r||t instanceof Document?r&&(s.mostRecentlyFocusedNode=t):(e.stopImmediatePropagation(),h(s.mostRecentlyFocusedNode||d()))},m=function(e){var t=i5(e);c();var r=null;if(s.tabbableGroups.length>0){var i=a(t),o=i>=0?s.containerGroups[i]:void 0;if(i<0)r=e.shiftKey?s.tabbableGroups[s.tabbableGroups.length-1].lastTabbableNode:s.tabbableGroups[0].firstTabbableNode;else if(e.shiftKey){var d=i9(s.tabbableGroups,function(e){return t===e.firstTabbableNode});if(d<0&&(o.container===t||i2(t,n.tabbableOptions)&&!i0(t,n.tabbableOptions)&&!o.nextTabbableNode(t,!1))&&(d=i),d>=0){var u=0===d?s.tabbableGroups.length-1:d-1;r=s.tabbableGroups[u].lastTabbableNode}}else{var p=i9(s.tabbableGroups,function(e){return t===e.lastTabbableNode});if(p<0&&(o.container===t||i2(t,n.tabbableOptions)&&!i0(t,n.tabbableOptions)&&!o.nextTabbableNode(t))&&(p=i),p>=0){var f=p===s.tabbableGroups.length-1?0:p+1;r=s.tabbableGroups[f].firstTabbableNode}}}else r=l("fallbackFocus");r&&(e.preventDefault(),h(r))},g=function(e){if(("Escape"===e.key||"Esc"===e.key||27===e.keyCode)&&!1!==i7(n.escapeDeactivates,e)){e.preventDefault(),r.deactivate();return}if("Tab"===e.key||9===e.keyCode){m(e);return}},v=function(e){a(i5(e))>=0||i7(n.clickOutsideDeactivates,e)||i7(n.allowOutsideClick,e)||(e.preventDefault(),e.stopImmediatePropagation())},y=function(){if(s.active)return i6.activateTrap(r),s.delayInitialFocusTimer=n.delayInitialFocus?i8(function(){h(d())}):h(d()),i.addEventListener("focusin",f,!0),i.addEventListener("mousedown",p,{capture:!0,passive:!1}),i.addEventListener("touchstart",p,{capture:!0,passive:!1}),i.addEventListener("click",v,{capture:!0,passive:!1}),i.addEventListener("keydown",g,{capture:!0,passive:!1}),r},_=function(){if(s.active)return i.removeEventListener("focusin",f,!0),i.removeEventListener("mousedown",p,!0),i.removeEventListener("touchstart",p,!0),i.removeEventListener("click",v,!0),i.removeEventListener("keydown",g,!0),r};return(r={get active(){return s.active},get paused(){return s.paused},activate:function(e){if(s.active)return this;var t=o(e,"onActivate"),r=o(e,"onPostActivate"),n=o(e,"checkCanFocusTrap");n||c(),s.active=!0,s.paused=!1,s.nodeFocusedBeforeActivation=i.activeElement,t&&t();var a=function(){n&&c(),y(),r&&r()};return n?(n(s.containers.concat()).then(a,a),this):(a(),this)},deactivate:function(e){if(!s.active)return this;var t=i3({onDeactivate:n.onDeactivate,onPostDeactivate:n.onPostDeactivate,checkCanReturnFocus:n.checkCanReturnFocus},e);clearTimeout(s.delayInitialFocusTimer),s.delayInitialFocusTimer=void 0,_(),s.active=!1,s.paused=!1,i6.deactivateTrap(r);var i=o(t,"onDeactivate"),a=o(t,"onPostDeactivate"),l=o(t,"checkCanReturnFocus"),d=o(t,"returnFocus","returnFocusOnDeactivate");i&&i();var c=function(){i8(function(){d&&h(u(s.nodeFocusedBeforeActivation)),a&&a()})};return d&&l?(l(u(s.nodeFocusedBeforeActivation)).then(c,c),this):(c(),this)},pause:function(){return s.paused||!s.active||(s.paused=!0,_()),this},unpause:function(){return s.paused&&s.active&&(s.paused=!1,c(),y()),this},updateContainerElements:function(e){var t=[].concat(e).filter(Boolean);return s.containers=t.map(function(e){return"string"==typeof e?i.querySelector(e):e}),s.active&&c(),this}}).updateContainerElements(e),r};let nt={base:"esri-identity-modal",open:"esri-identity-modal--open",closed:"esri-identity-modal--closed",title:"esri-identity-modal__title",dialog:"esri-identity-modal__dialog",content:"esri-identity-modal__content",closeButton:"esri-identity-modal__close-button",iconClose:"esri-icon-close"},nr=class extends iA{constructor(e,t){super(e,t),this.container=document.createElement("div"),this.content=null,this.open=!1,this._focusTrap=null,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.addHandles(T(()=>this.open,()=>this._toggleFocusTrap()))}destroy(){this._destroyFocusTrap()}get title(){return this.messages?.auth.signIn}render(){let e=this.id,{open:t,content:r,title:i,messages:n}=this,s=t&&!!r,o={[nt.open]:s,[nt.closed]:!s},a=iT("button",{class:nt.closeButton,"aria-label":n.close,title:n.close,bind:this,onclick:this._close,type:"button"},iT("span",{"aria-hidden":"true",class:nt.iconClose})),l=`${e}_title`,d=`${e}_content`,c=i?iT("h1",{id:l,class:nt.title},i):null,h=s?iT("div",{bind:this,class:nt.dialog,role:"dialog","aria-labelledby":l,"aria-describedby":d,afterCreate:this._createFocusTrap},a,c,this._renderContent(d)):null;return iT("div",{tabIndex:-1,class:this.classes(nt.base,o)},h)}_destroyFocusTrap(){this._focusTrap?.deactivate({onDeactivate(){}}),this._focusTrap=null}_toggleFocusTrap(){let{_focusTrap:e,open:t}=this;e&&(t?e.activate():e.deactivate())}_createFocusTrap(e){this._destroyFocusTrap();let t=requestAnimationFrame(()=>{this._focusTrap=ne(e,{initialFocus:"input",onDeactivate:this._close}),this._toggleFocusTrap()});this.addHandles((0,b.kB)(()=>cancelAnimationFrame(t)))}_renderContent(e){let t=this.content;return"string"==typeof t?iT("div",{class:nt.content,id:e,innerHTML:t}):t&&"function"==typeof t.render?iT("div",{class:nt.content,id:e},t.render()):t instanceof HTMLElement?iT("div",{class:nt.content,id:e,bind:t,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};(0,m._)([(0,E.Cb)({readOnly:!0})],nr.prototype,"container",void 0),(0,m._)([(0,E.Cb)()],nr.prototype,"content",void 0),(0,m._)([(0,E.Cb)()],nr.prototype,"open",void 0),(0,m._)([(0,E.Cb)(),ix("esri/t9n/common")],nr.prototype,"messages",void 0),(0,m._)([(0,E.Cb)()],nr.prototype,"title",null),nr=(0,m._)([(0,w.j)("esri.identity.IdentityModal")],nr);let ni=nr,nn="esriJSAPIOAuth";class ns{constructor(e,t){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=e,this.storage=t,this._init()}isValid(){let e=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token)){if(null==this.expires&&this.refreshToken)e=!0;else if(this.expires){let t=Date.now();this.expires>t&&(this.expires-t)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(e=!0)}}return e}save(){if(!this.storage)return!1;let e=this._load(),t=this.oAuthInfo;if(t&&t.authNamespace&&t.portalUrl){let r=e[t.authNamespace];r||(r=e[t.authNamespace]={}),this.appId||(this.appId=t.appId),r[t.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(nn,JSON.stringify(e))}catch(i){return console.warn(i),!1}return!0}return!1}destroy(){let e=this._load(),t=this.oAuthInfo;if(t&&t.appId&&t.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){let r=t.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",i=new FormData;if(i.append("f","json"),i.append("auth_token",this.refreshToken||this.token),i.append("client_id",t.appId),i.append("token_type_hint",this.refreshToken?"refresh_token":"access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(r,i);else{let n=new XMLHttpRequest;n.open("POST",r),n.send(i)}}if(t&&t.authNamespace&&t.portalUrl&&this.storage){let s=e[t.authNamespace];if(s){delete s[t.portalUrl];try{this.storage.setItem(nn,JSON.stringify(e))}catch(o){console.log(o)}}}t&&(t._oAuthCred=null,this.oAuthInfo=null)}_init(){let e=this._load(),t=this.oAuthInfo;if(t&&t.authNamespace&&t.portalUrl){let r=e[t.authNamespace];r&&(r=r[t.portalUrl])&&(this.appId=r.appId,this.codeVerifier=r.codeVerifier,this.expires=r.expires,this.refreshToken=r.refreshToken,this.ssl=r.ssl,this.stateUID=r.stateUID,this.token=r.token,this.userId=r.userId)}}_load(){let e={};if(this.storage){let t=this.storage.getItem(nn);if(t)try{e=JSON.parse(t)}catch(r){console.warn(r)}}return e}}ns.prototype.declaredClass="esri.identity.OAuthCredential";var no=r(4678);let na=p=class extends no.wq{constructor(e){super(e),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.flowType="auto",this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return p.fromJSON(this.toJSON())}};(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"appId",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"authNamespace",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"expiration",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"flowType",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"forceLogin",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"forceUserId",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"locale",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"minTimeUntilExpiration",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"popup",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"popupCallbackUrl",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"popupWindowFeatures",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"portalUrl",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"preserveUrlHash",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],na.prototype,"userId",void 0),na=p=(0,m._)([(0,w.j)("esri.identity.OAuthInfo")],na);let nl=na,nd=class extends no.wq{constructor(e){super(e),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"adminTokenServiceUrl",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"currentVersion",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"hasPortal",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"hasServer",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"owningSystemUrl",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"owningTenant",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"server",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"shortLivedTokenValidity",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"tokenServiceUrl",void 0),(0,m._)([(0,E.Cb)({json:{write:!0}})],nd.prototype,"webTierAuth",void 0),nd=(0,m._)([(0,w.j)("esri.identity.ServerInfo")],nd);let nc=nd;var nh=r(1924);let nu={},np=e=>{let t=new N.R9(e.owningSystemUrl).host,r=new N.R9(e.server).host,i=/.+\.arcgis\.com$/i;return i.test(t)&&i.test(r)},nf=(e,t)=>!!(np(e)&&t&&t.some(t=>t.test(e.server))),nm=null,ng=null;try{nm=window.localStorage,ng=window.sessionStorage}catch{}class nv extends I{constructor(){super(),this._portalConfig=globalThis.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this._defaultOAuthInfo=null,this._defaultTokenValidity=60,this.dialog=null,this.formConstructor=iR,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin="null"!==window.origin?window.origin:window.location.origin,this._appUrlObj=(0,N.mN)(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthLocationParams=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\/users\/([^\/]+)\/?.*/i,this._gwItem=/http.+\/items\/([^\/]+)\/?.*/i,this._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthLocationParams(),window.addEventListener("pageshow",e=>{this._pageShowHandler(e)})}registerServers(e){let t=this.serverInfos;t?(e=e.filter(e=>!this.findServerInfo(e.server)),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach(e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)})}registerOAuthInfos(e){let t=this.oAuthInfos;if(t){for(let r of e){let i=this.findOAuthInfo(r.portalUrl);i&&t.splice(t.indexOf(i),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};let t=this._sanitizeUrl(e.server),r=this._isServerRsrc(t),i,n=this.findServerInfo(t),s=!0;n||((n=new nc).server=this._getServerInstanceRoot(t),r?n.hasServer=!0:(n.tokenServiceUrl=this._getTokenSvcUrl(t),n.hasPortal=!0),this.registerServers([n])),(i=this._findCredential(t))?(delete e.server,Object.assign(i,e),s=!1):((i=new ny({userId:e.userId,server:n.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:r?"server":"portal"})).resources=[t],this.credentials.push(i)),i.emitTokenChange(!1),s||i.refreshServerTokens()}toJSON(){return(0,k.yd)({serverInfos:this.serverInfos.map(e=>e.toJSON()),oAuthInfos:this.oAuthInfos.map(e=>e.toJSON()),credentials:this.credentials.map(e=>e.toJSON())})}initialize(e){if(!e)return;"string"==typeof e&&(e=JSON.parse(e));let t=e.serverInfos,r=e.oAuthInfos,i=e.credentials;if(t){let n=[];t.forEach(e=>{e.server&&e.tokenServiceUrl&&n.push(e.declaredClass?e:new nc(e))}),n.length&&this.registerServers(n)}if(r){let s=[];r.forEach(e=>{e.appId&&s.push(e.declaredClass?e:new nl(e))}),s.length&&this.registerOAuthInfos(s)}i&&i.forEach(e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new ny(e)).emitTokenChange(),this.credentials.push(e))})}findServerInfo(e){let t;for(let r of(e=this._sanitizeUrl(e),this.serverInfos))if(this._hasSameServerInstance(r.server,e)){t=r;break}return t}findOAuthInfo(e){let t;for(let r of(e=this._sanitizeUrl(e),this.oAuthInfos))if(this._hasSameServerInstance(r.portalUrl,e)){t=r;break}return t}findCredential(e,t){let r;if(!e)return;e=this._sanitizeUrl(e);let i=this._isServerRsrc(e)?"server":"portal";if(t){for(let n of this.credentials)if(this._hasSameServerInstance(n.server,e)&&t===n.userId&&n.scope===i){r=n;break}}else for(let s of this.credentials)if(this._hasSameServerInstance(s.server,e)&&-1!==this._getIdenticalSvcIdx(e,s)&&s.scope===i){r=s;break}return r}getCredential(e,t){let r,i,n,s=!0;t&&(i=!!t.token,n=t.error,s=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);let o=new AbortController,a=(0,x.hh)();if(t.signal&&(0,x.fu)(t.signal,()=>{o.abort()}),(0,x.fu)(o,()=>{a.reject(new y.Z("identity-manager:user-aborted","ABORTED"))}),(0,x.Hc)(o))return a.promise;t.signal=o.signal;let l=this._isAdminResource(e),d=i?this.findCredential(e):null;if(d&&n&&n.details&&498===n.details.httpStatus)d.destroy();else if(d)return r=new y.Z("identity-manager:not-authorized","You are currently signed in as: '"+d.userId+"'. You do not have access to this resource: "+e,{error:n}),a.reject(r),a.promise;let c=this._findCredential(e,t);if(c)return a.resolve(c),a.promise;let h=this.findServerInfo(e);if(h)!h.hasServer&&this._isServerRsrc(e)&&(h._restInfoPms=this._getTokenSvcUrl(e),h.hasServer=!0);else{let u=this._getTokenSvcUrl(e);if(!u)return r=new y.Z("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),a.reject(r),a.promise;(h=new nc).server=this._getServerInstanceRoot(e),"string"==typeof u?(h.tokenServiceUrl=u,h.hasPortal=!0):(h._restInfoPms=u,h.hasServer=!0),this.registerServers([h])}return h.hasPortal&&void 0===h._selfReq&&(s||(0,N.D6)(h.tokenServiceUrl,this._appOrigin)||this._gwDomains.some(e=>e.tokenServiceUrl===h.tokenServiceUrl))&&(h._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(h.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),e)}),this._enqueue(e,h,t,a,l)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(e)&&e.replace(this._gwUser,"$1")||this._gwItem.test(e)&&e.replace(this._gwItem,"$1")||this._gwGroup.test(e)&&e.replace(this._gwGroup,"$1")||""}generateToken(e,t,r){let i,n,s,o,a,l,d,c;let h=this._rePortalTokenSvc.test(e.tokenServiceUrl),u=new N.R9(this._appOrigin),p=e.shortLivedTokenValidity;t&&(c=this.tokenValidity||p||this._defaultTokenValidity)>p&&p>0&&(c=p),r&&(i=r.isAdmin,n=r.serverUrl,s=r.token,l=r.signal,d=r.ssl,e.customParameters=r.customParameters),i?o=e.adminTokenServiceUrl:(o=e.tokenServiceUrl,a=new N.R9(o.toLowerCase()),e.webTierAuth&&r?.serverUrl&&!d&&"http"===u.scheme&&((0,N.D6)(u.uri,o,!0)||"https"===a.scheme&&u.host===a.host&&"7080"===u.port&&"7443"===a.port)&&(o=o.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));let f={query:{request:"getToken",username:t?.username,password:t?.password,serverUrl:n,token:s,expiration:c,referer:i||h?this._appOrigin:null,client:i?"referer":null,f:"json",...e.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(e,r),signal:l,...r?.ioArgs};return h||(f.withCredentials=!1),(0,v.default)(o,f).then(r=>{let i=r.data;if(!i||!i.token)return new y.Z("identity-manager:authentication-failed","Unable to generate token");let n=e.server;return nu[n]||(nu[n]={}),t&&(nu[n][t.username]=t.password),i.validity=c,i})}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,"").then(e=>e.credential)}checkAppAccess(e,t,r){let i=!1;return this.getCredential(e,{prompt:!1}).then(n=>{let s;let o={f:"json"};if("portal"===n.scope){if(t&&(this._doPortalSignIn(e)||r&&r.force))s=n.server+"/sharing/rest/oauth2/validateAppAccess",o.client_id=t;else{if(!n.token)return{credential:n};s=n.server+"/sharing/rest"}}else{if(!n.token)return{credential:n};s=n.server+"/rest/services"}return n.token&&(o.token=n.token),(0,v.default)(s,{query:o,authMode:"anonymous"}).then(e=>{if(!1===e.data.valid)throw new y.Z("identity-manager:not-authorized",`You are currently signed in as: '${n.userId}'.`,e.data);return i=!!e.data.viewOnlyUserTypeApp,{credential:n}}).catch(e=>{if("identity-manager:not-authorized"===e.name)throw e;let t=e.details&&e.details.httpStatus;if(498===t)throw n.destroy(),new y.Z("identity-manager:not-authenticated","User is not signed in.");if(400===t)throw new y.Z("identity-manager:invalid-request");return{credential:n}})}).then(e=>({credential:e.credential,viewOnly:i}))}setOAuthResponseHash(e){e&&("#"===e.charAt(0)&&(e=e.substring(1)),this._processOAuthPopupParams((0,N.u0)(e)))}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,r={}){let i=(0,x.hh)(),n=()=>{a?.remove(),l?.remove(),d?.remove(),o?.destroy(),this.dialog?.destroy(),this.dialog=o=a=l=d=null},s=()=>{n(),this._oAuthDfd=null,i.reject(new y.Z("identity-manager:user-aborted","ABORTED"))};r.signal&&(0,x.fu)(r.signal,()=>{s()});let o=new this.formConstructor;o.resource=this.getResourceName(e),o.server=t.server,this.dialog=new ni,this.dialog.content=o,this.dialog.open=!0,this.emit("dialog-create");let a=o.on("cancel",s),l=T(()=>this.dialog.open,s),d=o.on("submit",e=>{this.generateToken(t,e,{isAdmin:r.isAdmin,signal:r.signal}).then(s=>{n();let o=new ny({userId:e.username,server:t.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:r.isAdmin,validity:s.validity});i.resolve(o)}).catch(e=>{o.error=e,o.signingIn=!1})});return i.promise}oAuthSignIn(e,t,r,i){let n,s,o,a,l;this._oAuthDfd=(0,x.hh)();let d=this._oAuthDfd;i?.signal&&(0,x.fu)(i.signal,()=>{let e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&u()}),d.resUrl_=e,d.sinfo_=t,d.oinfo_=r;let c=r._oAuthCred;if(c.storage&&("authorization-code"===r.flowType||"auto"===r.flowType&&!r.popup&&t.currentVersion>=8.4)){let h=crypto.getRandomValues(new Uint8Array(32));n=(0,N.rS)(h),c.codeVerifier=n,h=crypto.getRandomValues(new Uint8Array(32)),c.stateUID=(0,N.rS)(h),c.save()||(c.codeVerifier=n=null)}else c.codeVerifier=null;this._getCodeChallenge(n).then(n=>{let d=!i||!1!==i.oAuthPopupConfirmation;r.popup&&d?((s=new this.formConstructor).oAuthPrompt=!0,s.server=t.server,this.dialog=new ni,this.dialog.content=s,this.dialog.open=!0,this.emit("dialog-create"),o=s.on("cancel",u),a=T(()=>this.dialog.open,u),l=s.on("submit",()=>{p(),this._doOAuthSignIn(e,t,r,n)})):this._doOAuthSignIn(e,t,r,n)});let u=()=>{p(),this._oAuthDfd=null,d.reject(new y.Z("identity-manager:user-aborted","ABORTED"))},p=()=>{o?.remove(),a?.remove(),l?.remove(),s?.destroy(),this.dialog?.destroy(),this.dialog=null};return d.promise}destroyCredentials(){this.credentials&&this.credentials.slice().forEach(e=>{e.destroy()}),this.emit("credentials-destroy")}enablePostMessageAuth(e="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=(0,S.on)(window,"message",t=>{if((t.origin===this._appOrigin||t.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===t.data?.type){let r=t.source;this.getCredential(e).then(e=>{r.postMessage({type:"arcgis:auth:credential",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)}).catch(e=>{r.postMessage({type:"arcgis:auth:error",error:{name:e.name,message:e.message}},t.origin)})}})}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthLocationParams(){let e=window.location.hash;if(e){"#"===e.charAt(0)&&(e=e.substring(1));let t=(0,N.u0)(e),r=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty("username"))try{t.state=JSON.parse(t.state),t.state.portalUrl&&(this._oAuthLocationParams=t,r=!0)}catch{}else if(t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(r=!0,t.state)))try{t.state=JSON.parse(t.state)}catch{}r&&(window.location.hash=t.state?.hash||"")}let i=window.location.search;if(i){"?"===i.charAt(0)&&(i=i.substring(1));let n=(0,N.u0)(i),s=!1;if(n.code&&n.state)try{n.state=JSON.parse(n.state),n.state.portalUrl&&n.state.uid&&(this._oAuthLocationParams=n,s=!0)}catch{}else if(n.error&&n.error_description&&(console.log("IdentityManager OAuth Error: ",n.error," - ",n.error_description),"access_denied"===n.error&&(s=!0,n.state)))try{n.state=JSON.parse(n.state)}catch{}if(s){let o={...n};["code","error","error_description","message_code","persist","state"].forEach(e=>{delete o[e]});let a=(0,N.B7)(o),l=window.location.pathname+(a?`?${a}`:"")+(n.state?.hash||"");window.history.replaceState(window.history.state,"",l)}}}_getOAuthToken(e,t,r,i,n){return e=e.replace(/^http:/i,"https:"),(0,v.default)(`${e}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:i&&n?{grant_type:"authorization_code",code:t,redirect_uri:i,client_id:r,code_verifier:n}:{grant_type:"refresh_token",refresh_token:t,client_id:r}}).then(e=>e.data)}_getCodeChallenge(e){if(e&&globalThis.isSecureContext){let t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-256",t).then(e=>(0,N.rS)(new Uint8Array(e)))}return Promise.resolve(null)}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){let t=new y.Z("identity-manager:user-aborted","ABORTED");this._errbackFunc(t)}}_findCredential(e,t){let r,i,n,s,o=-1,a=t&&t.token,l=t&&t.resource,d=this._isServerRsrc(e)?"server":"portal",c=this.credentials.filter(t=>this._hasSameServerInstance(t.server,e)&&t.scope===d);if(e=l||e,c.length){if(1===c.length){if(r=c[0],s=(i=(n=this.findServerInfo(r.server))&&n.owningSystemUrl)?this.findCredential(i,r.userId):void 0,o=this._getIdenticalSvcIdx(e,r),!a)return -1===o&&r.resources.push(e),this._addResource(e,s),r;-1!==o&&(r.resources.splice(o,1),this._removeResource(e,s))}else{let h,u;if(c.some(t=>-1!==(u=this._getIdenticalSvcIdx(e,t))&&(h=t,s=(i=(n=this.findServerInfo(h.server))&&n.owningSystemUrl)?this.findCredential(i,h.userId):void 0,o=u,!0)),a)h&&(h.resources.splice(o,1),this._removeResource(e,s));else if(h)return this._addResource(e,s),h}}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t){for(let r of this.oAuthInfos)if(this._isIdProvider(r.portalUrl,e)){t=r;break}}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let r=-1;t&&(r=this._getIdenticalSvcIdx(e,t))>-1&&t.resources.splice(r,1)}_useProxy(e,t){return t&&t.isAdmin&&!(0,N.D6)(e.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(e.tokenServiceUrl)&&"10.1"===String(e.currentVersion)&&!(0,N.D6)(e.tokenServiceUrl,this._appOrigin)}_getOrigin(e){let t=new N.R9(e);return t.scheme+"://"+t.host+(null!=t.port?":"+t.port:"")}_getServerInstanceRoot(e){let t=e.toLowerCase(),r=t.indexOf(this._agsRest);return -1===r&&this._isAdminResource(e)&&(r=this._agsAdmin.test(e)?e.replace(this._agsAdmin,"$1").length:e.search(this._adminSvcs)),-1!==r||(0,nh.P)(t)||(r=t.indexOf("/sharing")),-1===r&&"/"===t.substr(-1)&&(r=t.length-1),r>-1?e.substring(0,r):e}_hasSameServerInstance(e,t){return"/"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(":")))===(t=t.substr(t.indexOf(":")))}_normalizeAGOLorgDomain(e){let t=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return t.test(e)?e=e.replace(t,"https://www.arcgis.com"):r.test(e)?e=e.replace(r,"https://devext.arcgis.com"):i.test(e)&&(e=e.replace(i,"https://qaext.arcgis.com")),e}_sanitizeUrl(e){let t=(g.Z.request.proxyUrl||"").toLowerCase(),r=t?e.toLowerCase().indexOf(t+"?"):-1;return -1!==r&&(e=e.substring(r+t.length+1)),e=(0,N.Fv)(e),(0,N.mN)(e).path}_isRESTService(e){return e.includes(this._agsRest)}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let r=!1;if(this._isRESTService(e)&&this._isRESTService(t)){let i=this._getSuffix(e).toLowerCase(),n=this._getSuffix(t).toLowerCase();if(!(r=i===n)){let s=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;r=i.replace(s,"$1")===n.replace(s,"$1")}}else this._isAdminResource(e)&&this._isAdminResource(t)?r=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(r=!0);return r}_isPortalDomain(e){let t=new N.R9(e.toLowerCase()),r=this._portalConfig,i=this._gwDomains.some(e=>e.regex.test(t.uri));return!i&&r&&(i=this._hasSameServerInstance(this._getServerInstanceRoot(r.restBaseUrl),t.uri)),i||g.Z.portalUrl&&(i=(0,N.D6)(t,g.Z.portalUrl,!0)),i||(i=this._portals.some(e=>this._hasSameServerInstance(e,t.uri))),i=i||this._agsPortal.test(t.path)}_isIdProvider(e,t){let r=-1,i=-1;this._gwDomains.forEach((n,s)=>{-1===r&&n.regex.test(e)&&(r=s),-1===i&&n.regex.test(t)&&(i=s)});let n=!1;if(r>-1&&i>-1&&(0===r||4===r?0!==i&&4!==i||(n=!0):1===r?1!==i&&2!==i||(n=!0):2===r?2===i&&(n=!0):3===r&&3===i&&(n=!0)),!n){let s=this.findServerInfo(t),o=s&&s.owningSystemUrl;o&&np(s)&&this._isPortalDomain(o)&&this._isIdProvider(e,o)&&(n=!0)}return n}_getIdenticalSvcIdx(e,t){let r=-1;for(let i=0;i<t.resources.length;i++){let n=t.resources[i];if(this._isIdenticalService(e,n)){r=i;break}}return r}_getSuffix(e){return e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(e){let t,r;if(this._isRESTService(e)||this._isAdminResource(e)){let i=this._getServerInstanceRoot(e);return t=(0,v.default)(e=i+"/rest/info",{query:{f:"json"}}).then(e=>e.data),{adminUrl:i+"/admin/generateToken",promise:t}}if(this._isPortalDomain(e)){let n="";if(this._gwDomains.some(t=>(t.regex.test(e)&&(n=t.tokenServiceUrl),!!n)),n||this._portals.some(t=>(this._hasSameServerInstance(t,e)&&(n=t+this._gwTokenUrl),!!n)),n||-1!==(r=e.toLowerCase().indexOf("/sharing"))&&(n=e.substring(0,r)+this._gwTokenUrl),n||(n=this._getOrigin(e)+this._gwTokenUrl),n){let s=new N.R9(e).port;/^http:\/\//i.test(e)&&"7080"===s&&(n=n.replace(/:7080/i,":7443")),n=n.replace(/http:/i,"https:")}return n}if(e.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"}_processOAuthResponseParams(e,t,r){let i=t._oAuthCred;if(e.code){let n=i.codeVerifier;return i.codeVerifier=null,i.stateUID=null,i.save(),this._getOAuthToken(r.server,e.code,t.appId,this._getRedirectURI(t,!0),n).then(n=>{let s=new ny({userId:n.username,server:r.server,token:n.access_token,expires:Date.now()+1e3*n.expires_in,ssl:n.ssl,oAuthState:e.state,_oAuthCred:i});return t.userId=s.userId,i.storage=n.persist?nm:ng,i.refreshToken=n.refresh_token,i.token=null,i.expires=n.refresh_token_expires_in?Date.now()+1e3*n.refresh_token_expires_in:null,i.userId=s.userId,i.ssl=s.ssl,i.save(),s})}let s=new ny({userId:e.username,server:r.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:"true"===e.ssl,oAuthState:e.state,_oAuthCred:i});return t.userId=s.userId,i.storage=e.persist?nm:ng,i.refreshToken=null,i.token=s.token,i.expires=s.expires,i.userId=s.userId,i.ssl=s.ssl,i.save(),Promise.resolve(s)}_processOAuthPopupParams(e){let t=this._oAuthDfd;if(this._oAuthDfd=null,t){if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),e.error){let r="access_denied"===e.error,i=new y.Z(r?"identity-manager:user-aborted":"identity-manager:authentication-failed",r?"ABORTED":"OAuth: "+e.error+" - "+e.error_description);t.reject(i)}else this._processOAuthResponseParams(e,t.oinfo_,t.sinfo_).then(e=>{t.resolve(e)}).catch(e=>{t.reject(e)})}}_setOAuthResponseQueryString(e){e&&("?"===e.charAt(0)&&(e=e.substring(1)),this._processOAuthPopupParams((0,N.u0)(e)))}_exchangeToken(e,t,r){return(0,v.default)(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:t,token:r}}).then(e=>e.data.token)}_getPlatformSelf(e,t){return e=e.replace(/^http:/i,"https:"),(0,v.default)(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then(e=>e.data)}_getPortalSelf(e,t){let r;return(this._gwDomains.some(t=>(t.regex.test(e)&&(r=t.customBaseUrl),!!r)),r)?Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:r,portalMode:"multitenant",supportsOAuth:!0}):(this._appOrigin.startsWith("https:")?e=e.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),(0,v.default)(e,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then(e=>e.data))}_doPortalSignIn(e){let t=this._portalConfig,r=window.location.href,i=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(r)||!(i?i.hasPortal||i.owningSystemUrl&&this._isPortalDomain(i.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(r,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||(0,N.D6)(r,e,!0)))}_checkProtocol(e,t,r,i){let n=!0,s=i?t.adminTokenServiceUrl:t.tokenServiceUrl;return s.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&(0,N.ed)(s)&&!(n=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}))&&r(new y.Z("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection.")),n}_enqueue(e,t,r,i,n,s){return i||(i=(0,x.hh)()),i.resUrl_=e,i.sinfo_=t,i.options_=r,i.admin_=n,i.refresh_=s,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(i)):this._xoReqs.push(i):this._doSignIn(i),i.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;let t=t=>{let r=e.options_&&e.options_.resource,i=e.resUrl_,n=e.refresh_,s=!1;this.credentials.includes(t)||(n&&this.credentials.includes(n)?(n.userId=t.userId,n.token=t.token,n.expires=t.expires,n.validity=t.validity,n.ssl=t.ssl,n.creationTime=t.creationTime,s=!0,t=n):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.includes(r||i)||t.resources.push(r||i),t.scope=this._isServerRsrc(i)?"server":"portal",t.emitTokenChange();let o=this._soReqs,a={};this._soReqs=[],o.forEach(e=>{if(!this._isIdenticalService(i,e.resUrl_)){let r=this._getSuffix(e.resUrl_);a[r]||(a[r]=!0,t.resources.push(e.resUrl_))}}),e.resolve(t),o.forEach(e=>{this._hasSameServerInstance(this._getServerInstanceRoot(i),e.resUrl_)?e.resolve(t):this._soReqs.push(e)}),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,s||this.emit("credential-create",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},r=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=(n,s,o,a)=>{let l;let d=e.sinfo_,c=!e.options_||!1!==e.options_.prompt,h=d.hasPortal&&this._findOAuthInfo(e.resUrl_);if(n)t(new ny({userId:n,server:d.server,token:o||null,expires:null!=a?Number(a):null,ssl:!!s}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),e.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);let u=(0,S.on)(window,"message",e=>{e.source===window.parent&&e.data&&("arcgis:auth:credential"===e.data.type?(u.remove(),e.data.credential.expires<Date.now()?r(new y.Z("identity-manager:credential-request-failed","Parent application's token has expired.")):t(new ny(e.data.credential))):"arcgis:auth:error"===e.data.type&&(u.remove(),"tokenExpiredError"===e.data.error.name?r(new y.Z("identity-manager:credential-request-failed","Parent application's token has expired.")):r(y.Z.fromJSON(e.data.error))))});(0,x.fu)(e.options_?.signal,()=>{u.remove()})}else if(h){let p=h._oAuthCred;if(!p){let f=new ns(h,nm),m=new ns(h,ng);f.isValid()&&m.isValid()?f.expires>m.expires?(p=f,m.destroy()):(p=m,f.destroy()):p=f.isValid()?f:m,h._oAuthCred=p}if(p.isValid()){l=new ny({userId:p.userId,server:d.server,token:p.token,expires:p.expires,ssl:p.ssl,_oAuthCred:p});let g=h.appId!==p.appId&&this._doPortalSignIn(e.resUrl_);g||p.refreshToken?(e._pendingDfd=p.refreshToken?this._getOAuthToken(d.server,p.refreshToken,p.appId).then(e=>(l.expires=Date.now()+1e3*e.expires_in,l.token=e.access_token,l)):Promise.resolve(l),e._pendingDfd.then(e=>g?this._exchangeToken(e.server,h.appId,e.token).then(t=>(e.token=t,e)).catch(()=>e):e).then(e=>{t(e)}).catch(()=>{p?.destroy(),i()})):t(l)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(h.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===p.stateUID&&p.codeVerifier)){let v=this._oAuthLocationParams;this._oAuthLocationParams=null,e._pendingDfd=this._processOAuthResponseParams(v,h,d).then(e=>{t(e)}).catch(r)}else{let _=()=>{c?e._pendingDfd=this.oAuthSignIn(e.resUrl_,d,h,e.options_).then(t,r):r(new y.Z("identity-manager:not-authenticated","User is not signed in."))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(d.server,h.appId).then(e=>{(0,N.D6)(e.portalUrl,this._appOrigin,!0)?t(l=new ny({userId:e.username,server:d.server,expires:Date.now()+1e3*e.expires_in,token:e.token})):_()}).catch(_):_()}}else if(c){if(this._checkProtocol(e.resUrl_,d,r,e.admin_)){let b=e.options_;e.admin_&&((b=b||{}).isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,d,b).then(t,r)}}else r(new y.Z("identity-manager:not-authenticated","User is not signed in."))},n=()=>{let i,n,s,o;let a=e.sinfo_,l=a.owningSystemUrl,d=e.options_;if(d&&(i=d.token,n=d.error,s=d.prompt),!(o=this._findCredential(l,{token:i,resource:e.resUrl_}))){for(let c of this.credentials)if(this._isIdProvider(l,c.server)){o=c;break}}if(o){let h=this.findCredential(e.resUrl_,o.userId);if(h)t(h);else if(nf(a,this._legacyFed)){let u=o.toJSON();u.server=a.server,u.resources=null,t(new ny(u))}else(e._pendingDfd=this.generateToken(this.findServerInfo(o.server),null,{serverUrl:e.resUrl_,token:o.token,signal:e.options_.signal,ssl:o.ssl})).then(r=>{t(new ny({userId:o?.userId,server:a.server,token:r.token,expires:null!=r.expires?Number(r.expires):null,ssl:!!r.ssl,isAdmin:e.admin_,validity:r.validity}))},r)}else this._busy=null,i&&(e.options_.token=null),(e._pendingDfd=this.getCredential(l.replace(/\/?$/,"/sharing"),{resource:e.resUrl_,owningTenant:a.owningTenant,signal:e.options_.signal,token:i,error:n,prompt:s})).then(()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)},t=>{e.resUrl_=e.sinfo_=e.refresh_=null,e.reject(t)})};this._errbackFunc=r;let s=e.sinfo_.owningSystemUrl,o=this._isServerRsrc(e.resUrl_),a=e.sinfo_._restInfoPms;a?a.promise.then(t=>{let r=e.sinfo_;if(r._restInfoPms){r.adminTokenServiceUrl=r._restInfoPms.adminUrl,r._restInfoPms=null,r.tokenServiceUrl=((0,A.hS)("authInfo.tokenServicesUrl",t)||(0,A.hS)("authInfo.tokenServiceUrl",t)||(0,A.hS)("tokenServiceUrl",t))??null,r.shortLivedTokenValidity=(0,A.hS)("authInfo.shortLivedTokenValidity",t)??null,r.currentVersion=t.currentVersion,r.owningTenant=t.owningTenant;let s=r.owningSystemUrl=t.owningSystemUrl;s&&this._portals.push(s)}o&&r.owningSystemUrl?n():i()},()=>{e.sinfo_._restInfoPms=null;let t=new y.Z("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");r(t)}):o&&s?n():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then(t=>{let r,i,n,s;let o={};return t&&(r=t.user&&t.user.username,o.username=r,o.allSSL=t.allSSL,i=t.supportsOAuth,s=parseFloat(t.currentVersion),"multitenant"===t.portalMode&&(n=t.customBaseUrl),e.sinfo_.currentVersion=s),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:o.allSSL}).catch(()=>null).then(e=>(o.portalToken=e&&e.token,o.tokenExpiration=e&&e.expires,o)):!r&&i&&s>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:n,owningTenant:e.sinfo_._selfReq.owningTenant}).catch(()=>null).then(()=>o):o}).catch(()=>null).then(t=>{e.sinfo_._selfReq=null,t?i(t.username,t.allSSL,t.portalToken,t.tokenExpiration):i()}):i()}_generateOAuthInfo(e){let t,r=null,i=e.portalUrl,n=e.customBaseUrl,s=e.owningTenant,o=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(o){let a=(r=window.location.href).indexOf("?");a>-1&&(r=r.slice(0,a)),r=(a=r.search(/\/(apps|home)\//))>-1?r.slice(0,a):null}return o&&r?(this._hasTestedIfAppIsOnPortal=!0,t=(0,v.default)(r+"/sharing/rest",{query:{f:"json"}}).then(()=>{this._defaultOAuthInfo=new nl({appId:"arcgisonline",popupCallbackUrl:r+"/home/oauth-callback.html"})})):t=Promise.resolve(),t.then(()=>{if(this._defaultOAuthInfo)return i=i.replace(/^http:/i,"https:"),(0,v.default)(i+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:s,client_id:this._defaultOAuthInfo.appId,redirect_uri:(0,N.hF)(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then(e=>{if(e.data.valid){let t=this._defaultOAuthInfo.clone();e.data.urlKey&&n?t.portalUrl="https://"+e.data.urlKey.toLowerCase()+"."+n:t.portalUrl=i,t.popup=window!==window.top||!((0,N.D6)(i,this._appOrigin)||this._gwDomains.some(e=>e.regex.test(i)&&e.regex.test(this._appOrigin))),this.oAuthInfos.push(t)}})})}_doOAuthSignIn(e,t,r,i){let n=r._oAuthCred,s={portalUrl:r.portalUrl};!r.popup&&r.preserveUrlHash&&window.location.hash&&(s.hash=window.location.hash),n.stateUID&&(s.uid=n.stateUID);let o={client_id:r.appId,response_type:n.codeVerifier?"code":"token",state:JSON.stringify(s),expiration:r.expiration,locale:r.locale,redirect_uri:this._getRedirectURI(r,!!n.codeVerifier)};r.forceLogin&&(o.force_login=!0),r.forceUserId&&r.userId&&(o.prepopulatedusername=r.userId),!r.popup&&this._doPortalSignIn(e)&&(o.redirectToUserOrgUrl=!0),n.codeVerifier&&(o.code_challenge=i||n.codeVerifier,o.code_challenge_method=i?"S256":"plain");let a=r.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=a+"?"+(0,N.B7)(o);if(r.popup){let d=window.open(l,"esriJSAPIOAuth",r.popupWindowFeatures);if(d)d.focus(),this._oAuthDfd.oAuthWin_=d,this._oAuthIntervalId=setInterval(()=>{if(d.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle.remove();let e=this._oAuthDfd;if(e){let t=new y.Z("identity-manager:user-aborted","ABORTED");e.reject(t)}}},500),this._oAuthOnPopupHandle=(0,S.on)(window,["arcgis:auth:hash","arcgis:auth:location:search"],e=>{"arcgis:auth:hash"===e.type?this.setOAuthResponseHash(e.detail):this._setOAuthResponseQueryString(e.detail)});else{let c=new y.Z("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(c)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:a,resourceUrl:e,serverInfo:t,oAuthInfo:r}):window.location.href=l}_getRedirectURI(e,t){let r=window.location.href.replace(/#.*$/,"");if(e.popup)return(0,N.hF)(e.popupCallbackUrl);if(t){let i=(0,N.mN)(r);return i.query&&["code","error","error_description","message_code","persist","state"].forEach(e=>{delete i.query[e]}),(0,N.fl)(i.path,i.query)}return r}}nv.prototype.declaredClass="esri.identity.IdentityManagerBase";let ny=class extends I.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){let e=f.id.findServerInfo(this.server),t=e&&e.owningSystemUrl,r=!!t&&"server"===this.scope,i=r&&nf(e,f.id._legacyFed),n=e.webTierAuth,s=n&&f.id.normalizeWebTierAuth,o=nu[this.server],a=o&&o[this.userId],l,d=this.resources&&this.resources[0],c=r?f.id.findServerInfo(t):null,h={username:this.userId,password:a};if(n&&!s)return;r&&!c&&f.id.serverInfos.some(e=>(f.id._isIdProvider(t,e.server)&&(c=e),!!c));let u=c?f.id.findCredential(c.server,this.userId):null;if(!r||u){if(!i){if(r)l={serverUrl:d,token:u&&u.token,ssl:u&&u.ssl};else if(s)h=null,l={ssl:this.ssl};else{if(!a){let p;return d&&(d=f.id._sanitizeUrl(d),this._enqueued=1,(p=f.id._enqueue(d,e,null,null,this.isAdmin,this)).then(()=>{this._enqueued=0,this.refreshServerTokens()}).catch(()=>{this._enqueued=0})),p}this.isAdmin&&(l={isAdmin:!0})}return f.id.generateToken(r?c:e,r?null:h,l).then(e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()}).catch(()=>{})}u?.refreshToken()}}refreshServerTokens(){"portal"===this.scope&&f.id.credentials.forEach(e=>{let t=f.id.findServerInfo(e.server),r=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&r&&"server"===e.scope&&(f.id._hasSameServerInstance(this.server,r)||f.id._isIdProvider(r,this.server))&&(nf(t,f.id._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())})}emitTokenChange(e){clearTimeout(this._refreshTimer);let t=this.server&&f.id.findServerInfo(this.server),r=t&&t.owningSystemUrl,i=r&&f.id.findServerInfo(r);!1===e||r&&"portal"!==this.scope&&(!i||!i.webTierAuth||f.id.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);let e=f.id.credentials.indexOf(this);e>-1&&f.id.credentials.splice(e,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){let e=(0,k.yd)({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);let e=6e4*this.tokenRefreshBuffer,t=2147483648-1,r=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();r<0?r=0:r>t&&(r=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),r>e?r-e:r)}};(0,m._)([(0,E.Cb)()],ny.prototype,"creationTime",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"expires",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"isAdmin",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"oAuthState",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"resources",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"scope",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"server",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"ssl",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"token",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"tokenRefreshBuffer",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"userId",void 0),(0,m._)([(0,E.Cb)()],ny.prototype,"validity",void 0),ny=(0,m._)([(0,w.j)("esri.identity.Credential")],ny);class n_ extends nv{}n_.prototype.declaredClass="esri.identity.IdentityManager";let nb=new n_;(0,f.qh)(nb)}}]);